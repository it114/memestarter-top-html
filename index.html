<!DOCTYPE html>


<html lang="zh-CN,en,zh-TW,default">
  

    <head>
      <meta charset="utf-8" />
       
      <meta name="keywords" content="java php javascript go rust 区块链 ipfs etherum 电商系统 营销系统 游戏 智能合约" />
       
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> 张智进的博客</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css"
      />
      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    <link rel="alternate" href="/atom.xml" title="张智进的博客" type="application/atom+xml">
</head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      


<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['面朝大海，春暖花开', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-https-ssl-403-error"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/06/24/https-ssl-403-error/"
    >https-ssl-403-error</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/06/24/https-ssl-403-error/" class="article-date">
  <time datetime="2022-06-23T16:55:31.000Z" itemprop="datePublished">2022-06-24</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E8%BF%90%E7%BB%B4/">技术生活 - 编程技术 - 运维</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><p>由于用到小程序，需要配置ssl服务器；因为之前配置了好多次，以为这次这个事情也就10分钟的事情，谁知道花费了几个小时。按照正常流程申了ssl证书配置了域名和nginx ，当访问https:&#x2F;&#x2F;打开网站的的时候，莫名的打不开了。。。就以为是nginx配置问题。疯狂的找资料。因为服务器面板和云服务器443端口都开了，所以我就没往这里想。</p>
<h1 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h1><p>充分尝试之后，还是不行，之后，我一个一个的排查，先关闭防火墙；结果。。。。有反应了，https 出现了 403 ，巨大的进步。但是这一步怎么也解决不了。后来发现nginx文件没有配置默认的入口文件。</p>
<h1 id="经验"><a href="#经验" class="headerlink" title="经验"></a>经验</h1><p>遇到问题多方思考。最熟悉的地方👄容易忽略。<br>分享一个nginx配置文件生成网址，还挺有用的，可以根据nginx版本 ，ssl版本和其他一些方面，动态生成nginx配置还挺有用。<br><a target="_blank" rel="noopener" href="https://ssl-config.mozilla.org/#server=nginx&amp;version=1.20.2&amp;config=intermediate&amp;openssl=1.1.1k&amp;hsts=false&amp;ocsp=false&amp;guideline=5.6">https://ssl-config.mozilla.org/#server=nginx&amp;version=1.20.2&amp;config=intermediate&amp;openssl=1.1.1k&amp;hsts=false&amp;ocsp=false&amp;guideline=5.6</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/" rel="tag">问题记录</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-update-ganache-from-less-than-v6-x-x-to-v7-x-x"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/06/01/update-ganache-from-less-than-v6-x-x-to-v7-x-x/"
    >update-ganache-from-less-than-v6.x.x-to-v7.x.x</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/06/01/update-ganache-from-less-than-v6-x-x-to-v7-x-x/" class="article-date">
  <time datetime="2022-05-31T18:19:01.000Z" itemprop="datePublished">2022-06-01</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 编程技术 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="ganache不保存数据"><a href="#ganache不保存数据" class="headerlink" title="ganache不保存数据"></a>ganache不保存数据</h1><p>每次重启，账户都被情况，数据，交易全部都没了，每次重启reset了db。不想要这个效果，从文档看传入-db参数可以解决这个问题。无奈，这个V6.x.x有bug ，需要v7.x.x才行。</p>
<h1 id="升级"><a href="#升级" class="headerlink" title="升级"></a>升级</h1><p>v7.x.x的版本变化比较大</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Ganache npm packages have been combined and renamed from ganache-cli and ganache-core to ganache. You may need to uninstall the old packages before installing the new ganache.</span><br></pre></td></tr></table></figure>

<p>如果升级需要删除老版本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall --global ganache-cli ganache-core</span><br><span class="line">npm install --global ganache</span><br></pre></td></tr></table></figure>

<p>命令行参数也改了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x@y-MacBook-Pro ~ % ganache</span><br><span class="line">ganache v7.2.0 (@ganache/cli: 0.3.0, @ganache/core: 0.3.0)</span><br><span class="line">Starting RPC server</span><br></pre></td></tr></table></figure>

<p>参考：<a target="_blank" rel="noopener" href="https://github.com/trufflesuite/ganache/blob/develop/UPGRADE-GUIDE.md">https://github.com/trufflesuite/ganache/blob/develop/UPGRADE-GUIDE.md</a></p>
<h1 id="最好的解决方案"><a href="#最好的解决方案" class="headerlink" title="最好的解决方案"></a>最好的解决方案</h1><p>升级之后，还是有问题。可能是我配置有问题，ganache命令行应该就是为了内存设计。如果为了缓存数据，可以用ganache 的 UI 版本。<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220601024732.png" alt="20220601024732"><br>Remix 添加ganache的网络<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220601024705.png" alt="20220601024705"></p>
<p>ganache UI 版本有一个workspace概念，可以很好的隔离保存每次不同的数据区块</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ganache/" rel="tag">ganache</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-一文理清过度授权的是是非非"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/29/%E4%B8%80%E6%96%87%E7%90%86%E6%B8%85%E8%BF%87%E5%BA%A6%E6%8E%88%E6%9D%83%E7%9A%84%E6%98%AF%E6%98%AF%E9%9D%9E%E9%9D%9E/"
    >一文理清过度授权的是是非非</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/29/%E4%B8%80%E6%96%87%E7%90%86%E6%B8%85%E8%BF%87%E5%BA%A6%E6%8E%88%E6%9D%83%E7%9A%84%E6%98%AF%E6%98%AF%E9%9D%9E%E9%9D%9E/" class="article-date">
  <time datetime="2022-05-28T17:06:17.000Z" itemprop="datePublished">2022-05-29</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 编程技术 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="什么是过度授权"><a href="#什么是过度授权" class="headerlink" title="什么是过度授权"></a>什么是过度授权</h1><p>忘记在哪里看过一个脑静急转弯了。大致内容：如果你的区块链硬件钱包有10万元，玩dapp你最多能亏多少钱？答案显而易见：10万。当然，这个10万有很大可能不是dapp内部逻辑导致的亏损，而是因为它的钱包授权给了恶意DAPP，这个恶意dapp盗走了他的10万元。</p>
<p>这就是区块链世界的”黑暗森林“，大家都在猎杀金钱，活下去的的唯一途径就是别被第二者发现我们的低级错误。</p>
<h2 id="过度授权的案例"><a href="#过度授权的案例" class="headerlink" title="过度授权的案例"></a>过度授权的案例</h2><p>案例1： 2021 年 2 月份 ，中心化金融协议 Primitive由于合约漏洞，攻击者利用过度授权机制盗走了一部分资金。 <a target="_blank" rel="noopener" href="https://cryptopotato.com/defi-protocol-primitive-finance-self-hacks-to-prevent-exploit/">https://cryptopotato.com/defi-protocol-primitive-finance-self-hacks-to-prevent-exploit/</a><br>案例2：2021 年 2 月份， <a target="_blank" rel="noopener" href="https://rekt.news/furucombo-rekt/">https://rekt.news/furucombo-rekt/</a><br>案例3：我身边的朋友，自己偶尔玩玩dapp，自己本身也是做技术的，还被过度授权盗走了1000多U<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220529004454.png" alt="20220529004454"><br>更多过度授权案例 百度搜索：过度授权 或者 infinite approval  </p>
<h2 id="过度授权剖析"><a href="#过度授权剖析" class="headerlink" title="过度授权剖析"></a>过度授权剖析</h2><p>平时区块链转账，我们也没有使用过授权这个概念。授权这个概念大概是随着defi的兴起而火起来的，defi summber随便一个年化都很高，热钱涌动，进来了很多人。而这些defi大部分都是dapp，你需要授权给这些app使用你的资金，然后去赚钱。本质上，无论日常地址之间直接转账还是说dapp授权交易都是一个区块链的交易。怎么去区分和理解呢，如下图大致画 了一下我们平时转账交易和dapp授权的区别<br>日常转账交易（大致画了一下）<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220529005545.png" alt="20220529005545"><br>dapp授权交易<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220529010907.png" alt="20220529010907"></p>
<p>一言以蔽之，正常交易转账是自己直接转给地方地址。dapp授权是给第三方一个使用自己资金的权限，授权的时候可以指定币种和金额。<br>大家使用比较多的小狐狸授权页面如下，一旦遇到类似的页面，不熟悉的一定不要授权或者读取清楚每一个字。<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220529011159.png" alt="20220529011159"></p>
<h1 id="ERC20标准"><a href="#ERC20标准" class="headerlink" title="ERC20标准"></a>ERC20标准</h1><p>这个部分有一点偏技术，简单看一下，对于后边的内容会理解的更加深刻。ERC20标准大致是一个规定了以太坊区块链上的数字资产的生成，存储，转移等一系列操作的标准。有了这个标准之后，所有遵守ERC20协议的所有token之间既可以互操作了。</p>
<p>正常的erc20合约标准，大致有如下接口</p>
<p><a target="_blank" rel="noopener" href="https://eips.ethereum.org/EIPS/eip-20">https://eips.ethereum.org/EIPS/eip-20</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// https://github.com/ethereum/EIPs/issues/20</span><br><span class="line">  contract ERC20 &#123;</span><br><span class="line">      function totalSupply() constant returns (uint totalSupply);</span><br><span class="line">      function balanceOf(address _owner) constant returns (uint balance);</span><br><span class="line">      function transfer(address _to, uint _value) returns (bool success);</span><br><span class="line">      function transferFrom(address _from, address _to, uint _value) returns (bool success);</span><br><span class="line">      function approve(address _spender, uint _value) returns (bool success);</span><br><span class="line">      function allowance(address _owner, address _spender) constant returns (uint remaining);</span><br><span class="line">      event Transfer(address indexed _from, address indexed _to, uint _value);</span><br><span class="line">      event Approval(address indexed _owner, address indexed _spender, uint _value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>totalSupply token的总供应量</li>
<li>balanceOf 查询某一个地址的token余额</li>
<li>transfer 转移token从一个地址到另外一个地址</li>
<li>transferFrom  第三方从一个地址Token转移到一个地址</li>
<li>approve 给予其他地址授予token使用权限</li>
<li>allowance 查询既定的地址授予了哪些全新</li>
<li>Transfer 事件，token 发生转移就会有这个事件日志</li>
<li>Approval 授权事件</li>
</ul>
<p>看到了吗？erc20标准就6个函数2个事件。让人失望的是，标准中没有我们期望看到的撤销授权的函数方法！！！ 具体啥原因我暂时没有想清楚</p>
<h2 id="从代码角度看，我的钱是怎么被恶意dapp盗走的"><a href="#从代码角度看，我的钱是怎么被恶意dapp盗走的" class="headerlink" title="从代码角度看，我的钱是怎么被恶意dapp盗走的"></a>从代码角度看，我的钱是怎么被恶意dapp盗走的</h2><p>这里假设有两个用户A和B。用户A有100U 而且授权给了B使用这100U 。过程如下</p>
<ol>
<li>A调用 approve(address(B), 100)，授予B使用A的100Usdt的权限</li>
<li>B使用的时候需要检查A到底给自己了多少usdt的使用额度：allowance(address(A), address(B))</li>
<li>B知道了自己的使用额度之后调用转账transferFrom(address(A), address(B), 100) 把100U 从A转到B</li>
</ol>
<p>过程就是这么的简单！！！！！</p>
<p>虽然  transferFrom 函数被用来了盗用token，但是的设计目标是允许经过授权的地址使用我的token，在如下场景还是有不少用的</p>
<ul>
<li>让他人代付gas费用</li>
<li>dapp中允许dapp支配自己的资金去赚取收益 </li>
<li>订阅web3的一些服务，自动扣款等</li>
<li>代币归集，如果100000 个地址需要归集，你需要给10000个地址打手续费，而且每个地址都有零星的不能用的小数点后边N位的以太坊，好恐怖！如果授权就不一样了</li>
</ul>
<h3 id="手续费是谁来付"><a href="#手续费是谁来付" class="headerlink" title="手续费是谁来付"></a>手续费是谁来付</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">假设：A账号有10000个token代币,B账号没有token代币,C账号也没有token代币！</span><br><span class="line">那么：A账号 委托 B账号 转给C账号 100个token代币 怎么来实现呢？</span><br><span class="line">首先：A账号 和 B账号建立一种委托关联,登录A账户执行approve(b,100)方法结果为：结果：_allowed[A][B] = 100token</span><br><span class="line">然后：在执行登录B账户执行transferFrom(A,C,100),这里的B就是委托账号发送者,gas从B扣,必须确保token数量小于_allowed[A][B]</span><br><span class="line">总结：其实就是A转入C,但是要经过B的账号来发送交易！</span><br></pre></td></tr></table></figure>




<h1 id="如何防范过度授权威胁"><a href="#如何防范过度授权威胁" class="headerlink" title="如何防范过度授权威胁"></a>如何防范过度授权威胁</h1><ul>
<li>不要使用来源不明或者自己不信任的dapp</li>
<li>定期使用撤销授权工具清理授权</li>
<li>养成良好的习惯，经常用来玩dapp的钱包别放太多资金。</li>
</ul>
<h2 id="如何手动撤销过度授权"><a href="#如何手动撤销过度授权" class="headerlink" title="如何手动撤销过度授权"></a>如何手动撤销过度授权</h2><ol>
<li>一些钱包例如，tokenpocket ，imtoken  ，mathwallet 内部都内置了过度授权清理工具。</li>
<li>一些第三方网站，例如<a target="_blank" rel="noopener" href="https://approved.zone/">https://approved.zone/</a> ，debank，cointool 也都提供了类似的工具（提示：别因为清理授权被钓鱼了）</li>
<li>清理授权的过程是需要花费一定的gas 的 </li>
<li></li>
</ol>
<h2 id="过度授权一定能撤销干净吗"><a href="#过度授权一定能撤销干净吗" class="headerlink" title="过度授权一定能撤销干净吗"></a>过度授权一定能撤销干净吗</h2><h1 id="一种猜想"><a href="#一种猜想" class="headerlink" title="一种猜想"></a>一种猜想</h1><p>既然过度授权危害这么大。我有一些解决类似问题的想法。<br>建立一个权威的公用合约A。这个合约由一个dao组织运行，dapp项目方需要提供合约地址给合约A，一旦加入到合约A的白名单，就代表被加入的合约在一定程度上做了背书。加入白名单的项目方要么提供实名信息要么提供一些token质押，防止作恶。</p>
<p>在用户使用dapp的时候，不是直接授予权限给不受信任的dapp而是直接授权给dao运营的合约A。然后由合约A代理用户向目标合约做交互。</p>
<p>等于说在用户和目标dapp之间做了一个隔离，这个在一定程度上能解决授权过渡问题。</p>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>其实，这个话题展开的话，能说很多。包括从代码角度可以写一个demo来演示都是没问题的。只有真正的让用户看到了过度授权的危害才能真正的警醒用户授权的时候留一个心眼。而屡屡有用户因为过度授权上当受骗，大概是因为狼来了的故事挺多了，反正这事也不会发生在我身上。</p>
<p>哎，这个话题又涉及到哲学高度了，涉及到了人类学了。也罢，到此为止。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solidity/" rel="tag">solidity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%90%88%E7%BA%A6/" rel="tag">合约</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%A7%91%E6%99%AE/" rel="tag">科普</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-react-native-environment"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/23/react-native-environment/"
    >react-native-environment</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/23/react-native-environment/" class="article-date">
  <time datetime="2022-05-23T06:23:16.000Z" itemprop="datePublished">2022-05-23</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%89%8D%E7%AB%AF/">技术生活 - 编程技术 - 前端</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="前置条件"><a href="#前置条件" class="headerlink" title="前置条件"></a>前置条件</h2><p>由于react本质上是一套前端的开发流程，所以类似node ，npm等是必不可少的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew install node</span><br><span class="line">brew install watchman</span><br></pre></td></tr></table></figure>
<p>其中 watchman是用来监测文件变化的。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>这里区分ios和安卓开发环境。最简单的，安卓安装android studio，ios就安装xcode ~ 如果在遇到其他问题，搜一下，一下子就出来了。</p>
<h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx react-native init AwesomeProject</span><br></pre></td></tr></table></figure>

<h2 id="运行项目"><a href="#运行项目" class="headerlink" title="运行项目"></a>运行项目</h2><p>在项目根目录运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx react-native start</span><br></pre></td></tr></table></figure>
<p>这个命令把项目用到的所有依赖和代码合并成一个js文件。</p>
<h3 id="安卓平台"><a href="#安卓平台" class="headerlink" title="安卓平台"></a>安卓平台</h3><p>运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx react-native run-android</span><br></pre></td></tr></table></figure>
<p>安卓平台还可以打开Android studio，然后导入代码目录下面的android文件夹编译，安装。</p>
<p>如果报错，在命令行输入命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb reverset tcp:8081 tcp:8081 </span><br></pre></td></tr></table></figure>
<p>这句的意思是把电脑的8081端口的内容转发给手机端8081端口</p>
<h3 id="ios平台"><a href="#ios平台" class="headerlink" title="ios平台"></a>ios平台</h3><p>打开ios目录下的workspace，运行就很简单了，这里提一下签名。</p>
<ol>
<li>必须使用苹果官方数据线。否则无法识别设备</li>
<li>需要一个mobileprovision文件，这是一个描述文件。他包含的信息说明使用什么证书打包、AppID是什么、打包的App包含了哪些功能、可以在哪些设备上安装，则是通过Provisioning Profile 描述文件。</li>
</ol>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react/" rel="tag">react</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-Prisma入门"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/16/Prisma%E5%85%A5%E9%97%A8/"
    >Prisma入门</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/16/Prisma%E5%85%A5%E9%97%A8/" class="article-date">
  <time datetime="2022-05-16T08:24:19.000Z" itemprop="datePublished">2022-05-16</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-JavaScript/">技术生活 - 编程技术 - JavaScript</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Prisma-是什么"><a href="#Prisma-是什么" class="headerlink" title="Prisma 是什么"></a>Prisma 是什么</h1><p>Prisma是适用于Node.js和TypeScript的下一代开源ORM。ORM:对象关系映射（Object Relational Mapping）是一种程序设计技术。简单来说ORM可以将我们的底层数据库的各种操作进行一定的封装，我们就可以通过更加熟悉的开发语言来书写对应的数据库命令，ORM则可以将这些数据库操作命令转换为对应的SQL语句。GitHub上star数量很高，开发很活跃，社区也不错。关键是它的异步性，让JavaScript也拥有了高效查询db的能力。<br>Prisma它包含以下工具：</p>
<ul>
<li>Prisma Client—— 自动生成且类型安全的数据库客户端，这里边指定了语言和数据库啥的</li>
<li>Prisma Migrate—— 声明式数据建模和可自定义的迁移，和laravel或者thinkphp中的迁移概念类似</li>
<li>Prisma Studio—— 现代化的用户界面，可查看和编辑数据，可以想象为phhmyadmin</li>
</ul>
<h1 id="Prisma-环境配置"><a href="#Prisma-环境配置" class="headerlink" title="Prisma 环境配置"></a>Prisma 环境配置</h1><p>前提，nodejs必须安装<br>在这个前提下安装prisma</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install prisma typescript ts-node @types/node --save-dev</span><br></pre></td></tr></table></figure>


<h1 id="Prisma-基本用法"><a href="#Prisma-基本用法" class="headerlink" title="Prisma 基本用法"></a>Prisma 基本用法</h1><h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir prisma</span><br><span class="line">npm init -y </span><br></pre></td></tr></table></figure>
<p>上面的命会初始化一个npm项目，然后安装prisma依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install prisma -D </span><br></pre></td></tr></table></figure>
<p>安装之后，我们就可以使用npx命令了。 可以通过npx prisma init -h命令来查看prisma的命令<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220516164320.png" alt="20220516164320"></p>
<p>我们看到了prisma帮助信息中有一个init命令，这个就是我们用来初始化prisma的关键命令，这里我们初始化一个mysql的数据库文件</p>
<p>init指定数据库的格式是：*** DATABASE_URL&#x3D;”mysql:&#x2F;&#x2F;<USER>:<PASSWORD>@HOST:PORT&#x2F;DATABASE” ***</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx prisma init --url mysql://root:123456@localhost:3306/mydb</span><br></pre></td></tr></table></figure>

<p>来看看，执行之后，这个命令做了那些事情</p>
<ol>
<li>生成了一个.env文件</li>
<li>生成了prisma文件夹，里面有一个schema.prisma这个文件是我们后面用到的关键</li>
</ol>
<p>在根目录目前下面的文件大致如下<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220516165016.png" alt="20220516165016"></p>
<h2 id="prisma使用"><a href="#prisma使用" class="headerlink" title="prisma使用"></a>prisma使用</h2><h3 id="使用-Prisma-Migrate-创建数据表"><a href="#使用-Prisma-Migrate-创建数据表" class="headerlink" title="使用 Prisma Migrate 创建数据表"></a>使用 Prisma Migrate 创建数据表</h3><p>目前schema.prisma文件长这样。定义了两个表模型，User和Profile ，这两个表通过userId关联</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// This is your Prisma schema file,</span><br><span class="line">// learn more about it in the docs: https://pris.ly/d/prisma-schema</span><br><span class="line"></span><br><span class="line">generator client &#123;</span><br><span class="line">  provider = &quot;prisma-client-js&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">datasource db &#123;</span><br><span class="line">  provider = &quot;mysql&quot;</span><br><span class="line">  url      = env(&quot;DATABASE_URL&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model User &#123;</span><br><span class="line">  id      Int      @id @default(autoincrement())</span><br><span class="line">  email   String   @unique</span><br><span class="line">  name    String?</span><br><span class="line">  profile Profile?</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">model Profile &#123;</span><br><span class="line">  id     Int     @id @default(autoincrement())</span><br><span class="line">  bio    String?</span><br><span class="line">  user   User    @relation(fields: [userId], references: [id])</span><br><span class="line">  userId Int     @unique</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="使用-Prisma"><a href="#使用-Prisma" class="headerlink" title="使用 Prisma"></a>使用 Prisma</h3><p>使用迁移文件初始化数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npx prisma migrate dev --name init</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看看执行这个命令发生了什么吧</p>
<ol>
<li>生成数据库迁移文件</li>
<li>执行数据库迁移文件<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220516170012.png" alt="20220516170012"></li>
</ol>
<p>执行CRUD<br>在执行之前需要创建一个ts文件，这里我们创建一个index.ts的文件&#96; </p>
<ol>
<li>创建一个用户<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// create </span><br><span class="line">  const  c = await prismaClient.user.create(&#123;</span><br><span class="line">     data:&#123;</span><br><span class="line">         name:&#x27;xx&#x27;,</span><br><span class="line">         email:&#x27;123@qqq.com&#x27;,</span><br><span class="line">         profile:&#123;</span><br><span class="line">             create:&#123;bio:&#x27;im a girl&#x27;&#125;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;,</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></li>
<li>查询一个用户<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const user =  prismaClient.user.findFirst();</span><br><span class="line">console.dir(user, &#123; depth: null &#125;) </span><br></pre></td></tr></table></figure></li>
</ol>
<p>完整代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import &#123;  PrismaClient &#125; from &#x27;@prisma/client&#x27;</span><br><span class="line">const prismaClient = new PrismaClient();</span><br><span class="line"></span><br><span class="line">async function main() &#123; </span><br><span class="line">    // create </span><br><span class="line">    const  c = await prismaClient.user.create(&#123;</span><br><span class="line">       data:&#123;</span><br><span class="line">           name:&#x27;xx&#x27;,</span><br><span class="line">           email:&#x27;123@qqq.com&#x27;,</span><br><span class="line">           profile:&#123;</span><br><span class="line">               create:&#123;bio:&#x27;im a girl&#x27;&#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    console.log(&#x27;create user status = &#x27; + c );</span><br><span class="line">    const user =  prismaClient.user.findFirst();</span><br><span class="line">    console.dir(user, &#123; depth: null &#125;) </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line">  .catch((e) =&gt; &#123;</span><br><span class="line">    throw e</span><br><span class="line">  &#125;).finally(async () =&gt; &#123;</span><br><span class="line">    await prismaClient.$disconnect()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npx ts-node index.ts </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>数据库运行效果<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220516173323.png" alt="20220516173323"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javasctipt/" rel="tag">Javasctipt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NodeJS/" rel="tag">NodeJS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Prisma/" rel="tag">Prisma</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TypeScript/" rel="tag">TypeScript</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-区块链合约之10天学会solidity第四节-基本数据结构"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/01/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E5%9B%9B%E8%8A%82-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"
    >区块链合约之10天学会solidity第四节-基本数据结构</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/01/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E5%9B%9B%E8%8A%82-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="article-date">
  <time datetime="2022-05-01T05:30:12.000Z" itemprop="datePublished">2022-05-01</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 编程技术 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>学solidity已经2年了，平日除了偶尔写一点点合约喝读一点合约之外，几乎没有用武之地（工作中也用不到）。导致目前渐渐的有些生疏了。现在捡起来，希望有人一起再次一起学习。学习学习，有输入和输出才能学的更好。所以，我计划，没两天更新一波学习记录。我会把学习记录写成系列文章，把代码放到github，期待一起进步。也请大家到我的GitHub 给我star呀！也欢迎给我留言加个好友啥的。如果给我star的，联系我我会拉个共同学习的群v（jingyiwei）。<br>GitHub：<a href="mailto:&#103;&#105;&#116;&#64;&#x67;&#105;&#116;&#x68;&#x75;&#98;&#x2e;&#99;&#x6f;&#109;">&#103;&#105;&#116;&#64;&#x67;&#105;&#116;&#x68;&#x75;&#98;&#x2e;&#99;&#x6f;&#109;</a>:it114&#x2F;learn-solidity-30day.git<br>本文原文发表在张智进博客：<a href="https://www.memestarter.top/">https://www.memestarter.top/</a></p>
<h1 id="合约数据类型"><a href="#合约数据类型" class="headerlink" title="合约数据类型"></a>合约数据类型</h1> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solidity/" rel="tag">solidity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%90%88%E7%BA%A6/" rel="tag">合约</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-区块链合约之10天学会solidity第二节-初识合约"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/04/30/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E4%BA%8C%E8%8A%82-%E5%88%9D%E8%AF%86%E5%90%88%E7%BA%A6/"
    >区块链合约之10天学会solidity第二节-初识合约</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/30/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E4%BA%8C%E8%8A%82-%E5%88%9D%E8%AF%86%E5%90%88%E7%BA%A6/" class="article-date">
  <time datetime="2022-04-30T10:44:32.000Z" itemprop="datePublished">2022-04-30</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 编程技术 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>学solidity已经2年了，平日除了偶尔写一点点合约喝读一点合约之外，几乎没有用武之地（工作中也用不到）。导致目前渐渐的有些生疏了。现在捡起来，希望有人一起再次一起学习。学习学习，有输入和输出才能学的更好。所以，我计划，没两天更新一波学习记录。我会把学习记录写成系列文章，把代码放到github，期待一起进步。也请大家到我的GitHub 给我star呀！也欢迎给我留言加个好友啥的。如果给我star的，联系我我会拉个共同学习的群v（jingyiwei）。<br>GitHub：<a href="mailto:&#x67;&#x69;&#116;&#64;&#103;&#x69;&#116;&#104;&#x75;&#98;&#46;&#x63;&#x6f;&#109;">&#x67;&#x69;&#116;&#64;&#103;&#x69;&#116;&#104;&#x75;&#98;&#46;&#x63;&#x6f;&#109;</a>:it114&#x2F;learn-solidity-30day.git<br>本文原文发表在张智进博客：<a href="https://www.memestarter.top/">https://www.memestarter.top/</a></p>
<h1 id="合约结构"><a href="#合约结构" class="headerlink" title="合约结构"></a>合约结构</h1><h2 id="最简单的合约"><a href="#最简单的合约" class="headerlink" title="最简单的合约"></a>最简单的合约</h2><p>下面来看一段最简单的合约</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.4.0;</span><br><span class="line">contract SimpleStorage &#123;</span><br><span class="line">    string message;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分开来看</p>
<ul>
<li>第一行，代表合约所使用的许可证。不写也无所谓，不会报错；同时使用&#x2F;&#x2F;符号注释这一行，代表这一行不会被编译器编译</li>
<li>第二行，pragma 编译器指令 告诉编译器 合约使用 solidity编程语言，最低只是的solidity语言版本是 0.4.0。需要注意的是，pragma指令只对当前的文件起作用。^0.4.0 表示可以使用的版本为 0.4.0-0.4.9  之间的任意版本，但不能超过 0.5.0 版本。0.4.0-0.4.9 之间的小版本改动通常不会有破坏性更改，源代码应该都是兼容的。</li>
<li>第三行，创建了一个名字为 “SimpleStorage”的合约。</li>
<li>第四行，合约中，定义了一个变量message</li>
</ul>
<h2 id="合约编译"><a href="#合约编译" class="headerlink" title="合约编译"></a>合约编译</h2><p><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220506180910.png" alt="20220506180910"></p>
<h2 id="合约部署"><a href="#合约部署" class="headerlink" title="合约部署"></a>合约部署</h2><p><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220506181410.png" alt="20220506181410"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solidity/" rel="tag">solidity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%90%88%E7%BA%A6/" rel="tag">合约</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-区块链合约之10天学会solidity第三节-合约结构"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/04/29/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E4%B8%89%E8%8A%82-%E5%90%88%E7%BA%A6%E7%BB%93%E6%9E%84/"
    >区块链合约之10天学会solidity第三节-合约结构</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/29/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E4%B8%89%E8%8A%82-%E5%90%88%E7%BA%A6%E7%BB%93%E6%9E%84/" class="article-date">
  <time datetime="2022-04-29T00:40:30.000Z" itemprop="datePublished">2022-04-29</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 编程技术 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>学solidity已经2年了，平日除了偶尔写一点点合约喝读一点合约之外，几乎没有用武之地（工作中也用不到）。导致目前渐渐的有些生疏了。现在捡起来，希望有人一起再次一起学习。学习学习，有输入和输出才能学的更好。所以，我计划，没两天更新一波学习记录。我会把学习记录写成系列文章，把代码放到github，期待一起进步。也请大家到我的GitHub 给我star呀！也欢迎给我留言加个好友啥的。如果给我star的，联系我我会拉个共同学习的群v（jingyiwei）。<br>GitHub：<a href="mailto:&#103;&#105;&#x74;&#x40;&#x67;&#105;&#116;&#104;&#x75;&#98;&#46;&#99;&#x6f;&#x6d;">&#103;&#105;&#x74;&#x40;&#x67;&#105;&#116;&#104;&#x75;&#98;&#46;&#99;&#x6f;&#x6d;</a>:it114&#x2F;learn-solidity-30day.git<br>本文原文发表在张智进博客：<a href="https://www.memestarter.top/">https://www.memestarter.top/</a></p>
<h1 id="合约结构"><a href="#合约结构" class="headerlink" title="合约结构"></a>合约结构</h1><p>在上一篇中初步认识了合约，下面看一下在合约中都有哪些重要的构成。这一节的目的是的对合约有一个大致的印象。不会说太多的细节，只是我们可以在宏观上知道合约的构成，在后面的学习中做到心中有数。</p>
<p>solidity中合约其他面向对象编程语言中的类比较类似。在其他编程语言中类声明，变量声明等特性在合约中大致都可以找到相关的影子。只不过是换了个名字而已。</p>
<p>合约中可以包含大致有状态变量、 函数、 函数修饰器、事件、 结构类型、枚举类型，并合约也有继承机制</p>
<h2 id="状态变量"><a href="#状态变量" class="headerlink" title="状态变量"></a>状态变量</h2><p>状态变量存储在内存中，按照java或者别的面向对象的语言来理解，可以理解为类的成员变量。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string message; // 状态变量 ，消息</span><br></pre></td></tr></table></figure>


<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>函数是为了完成一些具有一定功能的代码的集合，可以被合约内部或者外部调用（注意函数的修饰符）<br>例如,下边是一个名称是setMessage的函数，接受一个string类型的参数，函数的可见性是public意味着在其他合约中也可以被调用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 设置消息函数</span><br><span class="line">    function setMessage(string amsg) public  isOwner &#123;  </span><br><span class="line">        message = amsg;</span><br><span class="line">        emit MessageChanged(msg.sender,amsg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="修饰器"><a href="#修饰器" class="headerlink" title="修饰器"></a>修饰器</h2><p>如上面的函数。函数的调用必须受到isOwner的限制。如果不是owener调用函数，就会报错。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 修饰器，这里判断交易是否是合约创建者发起交易</span><br><span class="line">   modifier isOwner() &#123;</span><br><span class="line">       require(msg.sender == owner, &quot;Caller is not owner&quot;);</span><br><span class="line">       _;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>


<h2 id="合约事件"><a href="#合约事件" class="headerlink" title="合约事件"></a>合约事件</h2><p>合约事件可以把合约运行过程中的事情给抛出去。关注这个事件的使用方可以关注并且根据事件做出自己的响应。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 定义事件</span><br><span class="line">   event MessageChanged(address addr,string message);</span><br></pre></td></tr></table></figure>



<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>其实，合约如果理解为一个java或者c#或者php等面向对象语言中的一个类，就会好很多。这篇文章只是简单的列举了合约中的一些成员，函数，事件等。没有涉及的内容太多，这里我们对合约结构有一个大致印象即可。</p>
<p>下面是一个完整的代码 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.4.0;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">contract SimpleStorage   &#123;</span><br><span class="line">    string message; // 状态变量 ，消息</span><br><span class="line">    address private owner;  // 状态变量 ，合约部署者</span><br><span class="line"></span><br><span class="line">    // 定义事件</span><br><span class="line">    event MessageChanged(address addr,string message);</span><br><span class="line"></span><br><span class="line">    // 构造方法，部署合约的时候调用</span><br><span class="line">    constructor() public &#123;</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 修饰器，这里判断交易是否是合约创建者发起交易</span><br><span class="line">    modifier isOwner() &#123;</span><br><span class="line">        require(msg.sender == owner, &quot;Caller is not owner&quot;);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 设置消息函数</span><br><span class="line">    function setMessage(string amsg) public  isOwner &#123;  </span><br><span class="line">        message = amsg;</span><br><span class="line">        emit MessageChanged(msg.sender,amsg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 读取消息函数</span><br><span class="line">    function getMessage() external  view  returns (string)&#123;</span><br><span class="line">        return message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>部署合约之后，我们就可以在remix ide里面调用 setMessage，然后调用 getMessage  就会看到我们刚才设置的 message<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220508214200.png" alt="20220508214200"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solidity/" rel="tag">solidity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%90%88%E7%BA%A6/" rel="tag">合约</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-区块链合约之10天学会solidity第一节-remix ide"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/04/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E4%B8%80%E8%8A%82-remix%20ide/"
    >区块链合约之10天学会solidity第一节-remix ide</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E4%B8%80%E8%8A%82-remix%20ide/" class="article-date">
  <time datetime="2022-04-28T10:11:20.000Z" itemprop="datePublished">2022-04-28</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 编程技术 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>学solidity已经2年了，平日除了偶尔写一点点合约喝读一点合约之外，几乎没有用武之地（工作中也用不到）。导致目前渐渐的有些生疏了。现在捡起来，希望有人一起再次一起学习。学习学习，有输入和输出才能学的更好。所以，我计划，没两天更新一波学习记录。我会把学习记录写成系列文章，把代码放到github，期待一起进步。也请大家到我的GitHub 给我star呀！也欢迎给我留言加个好友啥的。如果给我star的，联系我我会拉个共同学习的群v（jingyiwei）。<br>GitHub：<a href="mailto:&#x67;&#105;&#x74;&#64;&#x67;&#x69;&#x74;&#104;&#117;&#x62;&#46;&#x63;&#x6f;&#x6d;">&#x67;&#105;&#x74;&#64;&#x67;&#x69;&#x74;&#104;&#117;&#x62;&#46;&#x63;&#x6f;&#x6d;</a>:it114&#x2F;learn-solidity-30day.git<br>本文原文发表在张智进博客：<a href="https://www.memestarter.top/">https://www.memestarter.top/</a></p>
<h1 id="合约ide"><a href="#合约ide" class="headerlink" title="合约ide"></a>合约ide</h1><p>和很多编程语言一样，当你问学过的人该用什么ide来开发。清高的人活着xx的人会告诉你：记事本也可以。对于新手来说，一款好的编译器能帮助初学者少走弯路，建立信心。回忆起我的初学之后，从最初的vs code 到 <a target="_blank" rel="noopener" href="https://remix.ethereum.org/">https://remix.ethereum.org/</a> 在线ide，再到remix 桌面ide，最后还是觉得桌面ide要要用一些。说一下优缺点吧 </p>
<ul>
<li>VS code<br>需要安装插件，而且这个插件还有不同的开发者开发的插件，初学者要去选择。代码变现到编译到部署，中间要用到几个插件，都需要要初学者去探索。</li>
<li>remix 在线ide<br>打开网址就能编写代码，同一个ide，几乎啥都不配置，可以执行编写，编译和部署等诸多步骤。上手快，无需下载，用完即走</li>
<li>remix 桌面ide<br>和在线的remix一样，不一样的是可以打开本地workspace还有一些高级功能待探索。</li>
</ul>
<h1 id="remix"><a href="#remix" class="headerlink" title="remix"></a>remix</h1><h2 id="认识工作区"><a href="#认识工作区" class="headerlink" title="认识工作区"></a>认识工作区</h2><p>工作区大致如下，各个区域的功能<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220430183656.png" alt="20220430183656"></p>
<p>在编译页面，重要的配置项<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220430183827.png" alt="20220430183827"></p>
<p>部署页面重要配置项<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220430184102.png" alt="20220430184102"></p>
<p>第一段就到这了，需要多练多写</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ide/" rel="tag">ide</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solidity%E6%95%99%E7%A8%8B/" rel="tag">solidity教程</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%90%88%E7%BA%A6/" rel="tag">合约</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-椭圆曲线签名之区块链签名验证"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/04/26/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E7%AD%BE%E5%90%8D%E4%B9%8B%E5%8C%BA%E5%9D%97%E9%93%BE%E7%AD%BE%E5%90%8D%E9%AA%8C%E8%AF%81/"
    >椭圆曲线签名之区块链签名验证</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/26/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E7%AD%BE%E5%90%8D%E4%B9%8B%E5%8C%BA%E5%9D%97%E9%93%BE%E7%AD%BE%E5%90%8D%E9%AA%8C%E8%AF%81/" class="article-date">
  <time datetime="2022-04-26T03:12:04.000Z" itemprop="datePublished">2022-04-26</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 编程技术 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="对称加密"><a href="#对称加密" class="headerlink" title="对称加密"></a>对称加密</h1><p>学过计算机的人都知道知名度rsa加密算法。它使用了两个数字相乘很容易，但是把一个大数字分解为素数却很难的这个原理，来实现对称加密。但是随着计算机的发展rsa的安全性越来越受到挑战。于是在bitcoin中一个叫做椭圆曲线算法的对称加密算法被使用，并且在长期实践中证明了其安全性。</p>
<h1 id="椭圆曲线算法"><a href="#椭圆曲线算法" class="headerlink" title="椭圆曲线算法"></a>椭圆曲线算法</h1><p>椭圆曲线密码术是一种基于离散对数问题的非对称或公钥密码体系，如椭圆曲线上的加法和乘法运算。作为一种对称加密算法，椭圆曲线算法比ras算法用更小的公钥，实现更高的效率，实现了更高的安全性。</p>
<p>数字签名在比特币中有三种用途。</p>
<ol>
<li>签名证明私钥的所有者，即资金所有者，已经授权支出这些资金。</li>
<li>授权证明是不可否认的 （不可否认性）</li>
<li>签名证明交易（或交易的具体部分）在签字之后没有也不能被任何人修改</li>
</ol>
<h2 id="算法介绍"><a href="#算法介绍" class="headerlink" title="算法介绍"></a>算法介绍</h2><p>这部分可以参考：精通以太坊 （中文版）：<a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/ethereum_book-zh/spilt.6.4e6f5cb249c84882.md">https://www.bookstack.cn/read/ethereum_book-zh/spilt.6.4e6f5cb249c84882.md</a></p>
<h2 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h2><h2 id="椭圆曲线算法实现"><a href="#椭圆曲线算法实现" class="headerlink" title="椭圆曲线算法实现"></a>椭圆曲线算法实现</h2><p>总的来说，首先要生成一个随机数根据K&#x3D;k*P ，来确定私钥。<br>具体的在数字签名的时候，区块链使用的算法和正规的椭圆曲线算法有一定的差异。经过签名的消息是可以被分解为 r ，s的。只靠rs所反解的public key会有四组，不过实际上最常见的是2组，因为另外两种出现的概率很低很低。这篇文章有具体的说明：<a target="_blank" rel="noopener" href="https://bitcoin.stackexchange.com/questions/38351/ecdsa-v-r-s-what-is-v">https://bitcoin.stackexchange.com/questions/38351/ecdsa-v-r-s-what-is-v</a> 。 </p>
<h2 id="椭圆曲线算法签名实现"><a href="#椭圆曲线算法签名实现" class="headerlink" title="椭圆曲线算法签名实现"></a>椭圆曲线算法签名实现</h2><p>下面是代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class Sign &#123;</span><br><span class="line"></span><br><span class="line">    public static final String PERSONAL_MESSAGE_PREFIX = &quot;\u0019Ethereum Signed Message:\n&quot;;</span><br><span class="line"></span><br><span class="line">    public static void RecoverAddress) &#123;</span><br><span class="line"></span><br><span class="line">        String signature = &quot;xxxx&quot;;</span><br><span class="line"></span><br><span class="line">        String address = &quot;yyyy&quot;;</span><br><span class="line">        String message = &quot;msg&quot;;</span><br><span class="line"></span><br><span class="line">        String prefix = PERSONAL_MESSAGE_PREFIX + message.length();</span><br><span class="line">        byte[] msgHash = Hash.sha3((prefix + message).getBytes());</span><br><span class="line"></span><br><span class="line">        byte[] signatureBytes = Numeric.hexStringToByteArray(signature);</span><br><span class="line">        byte v = signatureBytes[64];</span><br><span class="line">        if (v &lt; 27) &#123;</span><br><span class="line">            v += 27;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        SignatureData sd =</span><br><span class="line">                new SignatureData(</span><br><span class="line">                        v,</span><br><span class="line">                        (byte[]) Arrays.copyOfRange(signatureBytes, 0, 32),</span><br><span class="line">                        (byte[]) Arrays.copyOfRange(signatureBytes, 32, 64)</span><br><span class="line">                );</span><br><span class="line"></span><br><span class="line">        String addressRecovered = null;</span><br><span class="line">        boolean match = false;</span><br><span class="line"></span><br><span class="line">        // Iterate for each possible key to recover</span><br><span class="line">        for (int i = 0; i &lt; 4; i++) &#123;</span><br><span class="line">            BigInteger publicKey =</span><br><span class="line">                    Sign.recoverFromSignature(</span><br><span class="line">                            (byte) i,</span><br><span class="line">                            new ECDSASignature(</span><br><span class="line">                                    new BigInteger(1, sd.getR()), new BigInteger(1, sd.getS())),</span><br><span class="line">                            msgHash);</span><br><span class="line"></span><br><span class="line">            if (publicKey != null) &#123;</span><br><span class="line">                addressRecovered = &quot;0x&quot; + Keys.getAddress(publicKey);</span><br><span class="line"></span><br><span class="line">                if (addressRecovered.equals(address)) &#123;</span><br><span class="line">                    match = true;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (addressRecovered.equals(address)) &#123;</span><br><span class="line">            System.out.println(&quot; recovered ... &quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (match) &#123;</span><br><span class="line">            System.out.println(&quot; match ... &quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/" rel="tag">数字签名</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2020-2022
        <i class="ri-heart-fill heart_icon"></i> zzj
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src=''></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="张智进的博客"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E6%B8%B8">旅游</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2021/11/11/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->
 <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  var ayerConfig = {
    mathjax: true,
  };
</script>

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->
 
<script src="/js/clickLove.js"></script>
 
<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>